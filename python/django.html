
<!DOCTYPE html>

<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Framework: Django &#8212; Fullcoder Manuales</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script src="../_static/translations.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Índice" href="../genindex.html" />
    <link rel="search" title="Búsqueda" href="../search.html" />
    <link rel="next" title="Microframework: Flask" href="flask.html" />
    <link rel="prev" title="Análisis de datos" href="analisis.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="es">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/fullcoderlogo.png" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Lenguajes de Marcado:
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../marcado/html.html">
   HTML5
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../marcado/css.html">
   CSS3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../marcado/restructured.html">
   reStructuredText
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  PHP:
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../php/sintaxis.html">
   Sintaxis PHP
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../php/funciones.html">
   Funciones predefinidas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../php/procesamiento.html">
   Comunicación Cliente / Servidor
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../php/database.html">
   Manipulación de base de datos
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../php/paquetes.html">
   Manejo de paquetes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../php/cifrado.html">
   Codificación y Hash
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../php/laravel.html">
   Framework: Laravel
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Python:
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="sintaxis.html">
   Sintaxis Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="funciones.html">
   Funciones predefinidas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="librerias.html">
   Librería Estandar
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="otras_librerias.html">
   Otras Librerías Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="database.html">
   Bases de datos
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="paquetes.html">
   Manejo de paquetes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="emails.html">
   Emails con Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="entornos.html">
   Entornos Virtuales
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="analisis.html">
   Análisis de datos
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Framework: Django
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="flask.html">
   Microframework: Flask
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="drf.html">
   Framework: Django Rest Framework
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="testing.html">
   Testing en Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="despliegue.html">
   Gunicorn: Despliegue web
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="monitorizar.html">
   Monitorización en Python
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  JavaScript:
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../javascript/sintaxis.html">
   Sintaxis javascript
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../javascript/funciones.html">
   Funciones
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../javascript/entornos.html">
   NVM: Entornos Virtuales
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../javascript/nodejs.html">
   Entornos: Node.JS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../javascript/expressjs.html">
   Framework: ExpressJS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../javascript/react.html">
   Framework: ReactJS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../javascript/react-native.html">
   Framework: React Native
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  TypeScript:
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../typescript/angular.html">
   Framework: Angular
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  GO:
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../go/sintaxis.html">
   Sintaxis GO
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../go/funciones.html">
   Funciones predefinidas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../go/librerias.html">
   Librería Estandar
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../go/concurrencia.html">
   Concurrencia
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../go/testing.html">
   Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../go/web.html">
   Desarrollo Web
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  C:
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../C/sintaxis.html">
   Sintaxis C
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../C/librerias.html">
   Librerías C
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  C++:
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../cplus/sintaxis.html">
   Sintaxis C
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  C#:
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../csharp/sintaxis.html">
   Sintaxis C#
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../csharp/funciones.html">
   Funciones predefinidas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../csharp/librerias.html">
   Namespace System
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../csharp/eventos.html">
   Eventos y Delegados
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../csharp/hilos.html">
   Threads (hilos)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../csharp/unity.html">
   Unity
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Java:
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../java/sintaxis.html">
   Sintaxis Java
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../java/funciones.html">
   Funciones
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../java/documentacion.html">
   Documentación en Java
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Bases de datos:
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../ddbb/mongodb.html">
   MongoDB
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Sistemas y herramientas:
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../sistemas/nginx.html">
   Nginx
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../sistemas/docker.html">
   Docker
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../sistemas/docker-compose.html">
   Docker-Compose
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../sistemas/heroku.html">
   Heroku
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../otros/vscode.html">
   Visual Studio Code
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Otros Lenguajes:
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../otros/basic.html">
   Basic y Commodore 64
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/python/django.rst.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.rst</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#configuraciones">
   Configuraciones
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creacion-del-proyecto">
     Creación del proyecto
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#configuracion-del-proyecto-settings-py">
     Configuración del proyecto (settings.py)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#arrancar-la-base-de-datos">
     Arrancar la base de datos
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trabajar-con-sqlite">
       Trabajar con SQLite
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trabajar-con-mysql">
       Trabajar con MySQL
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#crear-un-administrador">
     Crear un Administrador
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#crear-una-aplicacion">
     Crear una aplicación
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rutas">
   Rutas
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rutas-principales-prueba-urls-py">
     Rutas principales (prueba/urls.py)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rutas-en-app-nombre-app-urls-py">
     Rutas en App (nombre_app/urls.py)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rutas-con-parametros">
     rutas con parámetros
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rutas-de-cbv">
     Rutas de CBV
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#vistas">
   Vistas
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fbv-function-based-views">
     FBV (Function-Based Views)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cbv-class-based-views">
     CBV (Class-Based Views)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#templateview">
       TemplateView
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#listview">
       ListView
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#detailview">
       DetailView
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#createview">
       CreateView
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#updateview">
       UpdateView
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#deleteview">
       DeleteView
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#pasarle-un-formulario-a-una-cbv">
       Pasarle un formulario a una CBV
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#crear-un-nuevo-contexto">
       Crear un nuevo contexto
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#recuperar-datos-de-post-o-get">
       Recuperar datos de POST o GET
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#decoradores">
     Decoradores
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#middleware-en-django">
   Middleware en Django
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#crear-custom-middleware">
     Crear Custom Middleware
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#templates">
   Templates
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#template-tags">
     Template Tags
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#template-tag-base">
       Template tag base
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#template-tag-url">
       Template tag url
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#template-tag-static">
       Template tag static
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#template-tag-de-datos">
       Template tag de datos
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#template-tag-for">
       Template tag for
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#template-tag-if">
       Template tag if
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#crear-template-tags-customizados">
     Crear template tags customizados
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#simple-tag">
       Simple tag
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#filter-tags">
       Filter tags
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modelos">
   Modelos
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cargar-imagenes-en-modelos-con-pillow">
     Cargar imágenes en modelos con Pillow
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#modelo-de-muchos-a-muchos">
     Modelo de muchos a muchos
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generar-modelo-y-migrar-la-base-de-datos">
     Generar modelo y migrar la base de datos
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#orm-de-django-y-sus-querysets">
   ORM de Django y sus QuerySets
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#realizar-querysets-desde-vista-y-pasarlos-a-template">
     Realizar QuerySets desde vista y pasarlos a template
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#formularios">
   Formularios
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#crear-un-formulario-basico">
     Crear un formulario básico
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#crear-un-formulario-usando-su-modelo">
     Crear un formulario usando su modelo
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#crear-formulario-y-aceptar-parametros-para-su-configuracion">
     Crear formulario y aceptar parámetros para su configuración
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#utilizar-un-formulario">
     Utilizar un formulario
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#validar-un-formulario">
     Validar un formulario
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#usuarios-en-django">
   Usuarios en Django
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#users-o-usuarios">
     Users o usuarios
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#cargar-librerias">
       Cargar librerías
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sistema-de-autenticacion">
       Sistema de autenticación
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#cambiar-usuario-por-email">
       Cambiar usuario por email
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#permisos">
     Permisos
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#panel-de-administracion">
   Panel de administración
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#puesta-en-marcha">
     Puesta en marcha
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mostrar-datos-de-nuestros-modelos">
     Mostrar datos de nuestros modelos
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#personalizar-titulos-de-las-apps">
     Personalizar titulos de las Apps
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#personalizar-tablas">
     Personalizar tablas
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cambiar-titulo-al-panel">
     Cambiar título al panel
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#enviar-emails">
   Enviar Emails
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Framework: Django</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#configuraciones">
   Configuraciones
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creacion-del-proyecto">
     Creación del proyecto
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#configuracion-del-proyecto-settings-py">
     Configuración del proyecto (settings.py)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#arrancar-la-base-de-datos">
     Arrancar la base de datos
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trabajar-con-sqlite">
       Trabajar con SQLite
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trabajar-con-mysql">
       Trabajar con MySQL
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#crear-un-administrador">
     Crear un Administrador
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#crear-una-aplicacion">
     Crear una aplicación
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rutas">
   Rutas
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rutas-principales-prueba-urls-py">
     Rutas principales (prueba/urls.py)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rutas-en-app-nombre-app-urls-py">
     Rutas en App (nombre_app/urls.py)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rutas-con-parametros">
     rutas con parámetros
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rutas-de-cbv">
     Rutas de CBV
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#vistas">
   Vistas
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fbv-function-based-views">
     FBV (Function-Based Views)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cbv-class-based-views">
     CBV (Class-Based Views)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#templateview">
       TemplateView
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#listview">
       ListView
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#detailview">
       DetailView
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#createview">
       CreateView
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#updateview">
       UpdateView
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#deleteview">
       DeleteView
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#pasarle-un-formulario-a-una-cbv">
       Pasarle un formulario a una CBV
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#crear-un-nuevo-contexto">
       Crear un nuevo contexto
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#recuperar-datos-de-post-o-get">
       Recuperar datos de POST o GET
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#decoradores">
     Decoradores
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#middleware-en-django">
   Middleware en Django
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#crear-custom-middleware">
     Crear Custom Middleware
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#templates">
   Templates
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#template-tags">
     Template Tags
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#template-tag-base">
       Template tag base
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#template-tag-url">
       Template tag url
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#template-tag-static">
       Template tag static
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#template-tag-de-datos">
       Template tag de datos
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#template-tag-for">
       Template tag for
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#template-tag-if">
       Template tag if
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#crear-template-tags-customizados">
     Crear template tags customizados
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#simple-tag">
       Simple tag
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#filter-tags">
       Filter tags
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modelos">
   Modelos
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cargar-imagenes-en-modelos-con-pillow">
     Cargar imágenes en modelos con Pillow
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#modelo-de-muchos-a-muchos">
     Modelo de muchos a muchos
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generar-modelo-y-migrar-la-base-de-datos">
     Generar modelo y migrar la base de datos
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#orm-de-django-y-sus-querysets">
   ORM de Django y sus QuerySets
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#realizar-querysets-desde-vista-y-pasarlos-a-template">
     Realizar QuerySets desde vista y pasarlos a template
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#formularios">
   Formularios
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#crear-un-formulario-basico">
     Crear un formulario básico
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#crear-un-formulario-usando-su-modelo">
     Crear un formulario usando su modelo
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#crear-formulario-y-aceptar-parametros-para-su-configuracion">
     Crear formulario y aceptar parámetros para su configuración
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#utilizar-un-formulario">
     Utilizar un formulario
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#validar-un-formulario">
     Validar un formulario
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#usuarios-en-django">
   Usuarios en Django
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#users-o-usuarios">
     Users o usuarios
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#cargar-librerias">
       Cargar librerías
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sistema-de-autenticacion">
       Sistema de autenticación
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#cambiar-usuario-por-email">
       Cambiar usuario por email
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#permisos">
     Permisos
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#panel-de-administracion">
   Panel de administración
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#puesta-en-marcha">
     Puesta en marcha
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mostrar-datos-de-nuestros-modelos">
     Mostrar datos de nuestros modelos
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#personalizar-titulos-de-las-apps">
     Personalizar titulos de las Apps
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#personalizar-tablas">
     Personalizar tablas
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cambiar-titulo-al-panel">
     Cambiar título al panel
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#enviar-emails">
   Enviar Emails
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="framework-django">
<h1><a class="toc-backref" href="#id1">Framework: Django</a><a class="headerlink" href="#framework-django" title="Enlazar permanentemente con este título">#</a></h1>
<a class="reference internal image-reference" href="../_images/logo-django.png"><img alt="Logo Django" class="align-center" src="../_images/logo-django.png" style="width: 275.0px; height: 275.0px;" /></a>
<p>Documentación básica para trabajar con Django 3</p>
<div class="contents topic" id="indice">
<p class="topic-title">Índice</p>
<ul class="simple">
<li><p><a class="reference internal" href="#framework-django" id="id1">Framework: Django</a></p>
<ul>
<li><p><a class="reference internal" href="#configuraciones" id="id2">Configuraciones</a></p>
<ul>
<li><p><a class="reference internal" href="#creacion-del-proyecto" id="id3">Creación del proyecto</a></p></li>
<li><p><a class="reference internal" href="#configuracion-del-proyecto-settings-py" id="id4">Configuración del proyecto (settings.py)</a></p></li>
<li><p><a class="reference internal" href="#arrancar-la-base-de-datos" id="id5">Arrancar la base de datos</a></p>
<ul>
<li><p><a class="reference internal" href="#trabajar-con-sqlite" id="id6">Trabajar con SQLite</a></p></li>
<li><p><a class="reference internal" href="#trabajar-con-mysql" id="id7">Trabajar con MySQL</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#crear-un-administrador" id="id8">Crear un Administrador</a></p></li>
<li><p><a class="reference internal" href="#crear-una-aplicacion" id="id9">Crear una aplicación</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#rutas" id="id10">Rutas</a></p>
<ul>
<li><p><a class="reference internal" href="#rutas-principales-prueba-urls-py" id="id11">Rutas principales (prueba/urls.py)</a></p></li>
<li><p><a class="reference internal" href="#rutas-en-app-nombre-app-urls-py" id="id12">Rutas en App (nombre_app/urls.py)</a></p></li>
<li><p><a class="reference internal" href="#rutas-con-parametros" id="id13">rutas con parámetros</a></p></li>
<li><p><a class="reference internal" href="#rutas-de-cbv" id="id14">Rutas de CBV</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#vistas" id="id15">Vistas</a></p>
<ul>
<li><p><a class="reference internal" href="#fbv-function-based-views" id="id16">FBV (Function-Based Views)</a></p></li>
<li><p><a class="reference internal" href="#cbv-class-based-views" id="id17">CBV (Class-Based Views)</a></p>
<ul>
<li><p><a class="reference internal" href="#templateview" id="id18">TemplateView</a></p></li>
<li><p><a class="reference internal" href="#listview" id="id19">ListView</a></p></li>
<li><p><a class="reference internal" href="#detailview" id="id20">DetailView</a></p></li>
<li><p><a class="reference internal" href="#createview" id="id21">CreateView</a></p></li>
<li><p><a class="reference internal" href="#updateview" id="id22">UpdateView</a></p></li>
<li><p><a class="reference internal" href="#deleteview" id="id23">DeleteView</a></p></li>
<li><p><a class="reference internal" href="#pasarle-un-formulario-a-una-cbv" id="id24">Pasarle un formulario a una CBV</a></p></li>
<li><p><a class="reference internal" href="#crear-un-nuevo-contexto" id="id25">Crear un nuevo contexto</a></p></li>
<li><p><a class="reference internal" href="#recuperar-datos-de-post-o-get" id="id26">Recuperar datos de POST o GET</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#decoradores" id="id27">Decoradores</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#middleware-en-django" id="id28">Middleware en Django</a></p>
<ul>
<li><p><a class="reference internal" href="#crear-custom-middleware" id="id29">Crear Custom Middleware</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#templates" id="id30">Templates</a></p>
<ul>
<li><p><a class="reference internal" href="#template-tags" id="id31">Template Tags</a></p>
<ul>
<li><p><a class="reference internal" href="#template-tag-base" id="id32">Template tag base</a></p></li>
<li><p><a class="reference internal" href="#template-tag-url" id="id33">Template tag url</a></p></li>
<li><p><a class="reference internal" href="#template-tag-static" id="id34">Template tag static</a></p></li>
<li><p><a class="reference internal" href="#template-tag-de-datos" id="id35">Template tag de datos</a></p></li>
<li><p><a class="reference internal" href="#template-tag-for" id="id36">Template tag for</a></p></li>
<li><p><a class="reference internal" href="#template-tag-if" id="id37">Template tag if</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#crear-template-tags-customizados" id="id38">Crear template tags customizados</a></p>
<ul>
<li><p><a class="reference internal" href="#simple-tag" id="id39">Simple tag</a></p></li>
<li><p><a class="reference internal" href="#filter-tags" id="id40">Filter tags</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#modelos" id="id41">Modelos</a></p>
<ul>
<li><p><a class="reference internal" href="#cargar-imagenes-en-modelos-con-pillow" id="id42">Cargar imágenes en modelos con Pillow</a></p></li>
<li><p><a class="reference internal" href="#modelo-de-muchos-a-muchos" id="id43">Modelo de muchos a muchos</a></p></li>
<li><p><a class="reference internal" href="#generar-modelo-y-migrar-la-base-de-datos" id="id44">Generar modelo y migrar la base de datos</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#orm-de-django-y-sus-querysets" id="id45">ORM de Django y sus QuerySets</a></p>
<ul>
<li><p><a class="reference internal" href="#realizar-querysets-desde-vista-y-pasarlos-a-template" id="id46">Realizar QuerySets desde vista y pasarlos a template</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#formularios" id="id47">Formularios</a></p>
<ul>
<li><p><a class="reference internal" href="#crear-un-formulario-basico" id="id48">Crear un formulario básico</a></p></li>
<li><p><a class="reference internal" href="#crear-un-formulario-usando-su-modelo" id="id49">Crear un formulario usando su modelo</a></p></li>
<li><p><a class="reference internal" href="#crear-formulario-y-aceptar-parametros-para-su-configuracion" id="id50">Crear formulario y aceptar parámetros para su configuración</a></p></li>
<li><p><a class="reference internal" href="#utilizar-un-formulario" id="id51">Utilizar un formulario</a></p></li>
<li><p><a class="reference internal" href="#validar-un-formulario" id="id52">Validar un formulario</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#usuarios-en-django" id="id53">Usuarios en Django</a></p>
<ul>
<li><p><a class="reference internal" href="#users-o-usuarios" id="id54">Users o usuarios</a></p>
<ul>
<li><p><a class="reference internal" href="#cargar-librerias" id="id55">Cargar librerías</a></p></li>
<li><p><a class="reference internal" href="#sistema-de-autenticacion" id="id56">Sistema de autenticación</a></p></li>
<li><p><a class="reference internal" href="#cambiar-usuario-por-email" id="id57">Cambiar usuario por email</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#permisos" id="id58">Permisos</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#panel-de-administracion" id="id59">Panel de administración</a></p>
<ul>
<li><p><a class="reference internal" href="#puesta-en-marcha" id="id60">Puesta en marcha</a></p></li>
<li><p><a class="reference internal" href="#mostrar-datos-de-nuestros-modelos" id="id61">Mostrar datos de nuestros modelos</a></p></li>
<li><p><a class="reference internal" href="#personalizar-titulos-de-las-apps" id="id62">Personalizar titulos de las Apps</a></p></li>
<li><p><a class="reference internal" href="#personalizar-tablas" id="id63">Personalizar tablas</a></p></li>
<li><p><a class="reference internal" href="#cambiar-titulo-al-panel" id="id64">Cambiar título al panel</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#enviar-emails" id="id65">Enviar Emails</a></p></li>
</ul>
</li>
</ul>
</div>
<section id="configuraciones">
<h2><a class="toc-backref" href="#id2">Configuraciones</a><a class="headerlink" href="#configuraciones" title="Enlazar permanentemente con este título">#</a></h2>
<section id="creacion-del-proyecto">
<h3><a class="toc-backref" href="#id3">Creación del proyecto</a><a class="headerlink" href="#creacion-del-proyecto" title="Enlazar permanentemente con este título">#</a></h3>
<p>Crear entorno virtual y seguir estos pasos:</p>
<ul class="simple">
<li><p>Instalar Django: <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">django</span></code></p></li>
<li><p>crear un nuevo proyecto: <code class="docutils literal notranslate"><span class="pre">django-admin</span> <span class="pre">startproject</span> <span class="pre">nombre_proyecto</span></code></p></li>
<li><p>Arrancar servidor: <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">runserver</span></code></p></li>
<li><p>En el navegador: <code class="docutils literal notranslate"><span class="pre">localhost:8000</span></code> para ver si arrancó la aplicación.</p></li>
</ul>
</section>
<section id="configuracion-del-proyecto-settings-py">
<h3><a class="toc-backref" href="#id4">Configuración del proyecto (settings.py)</a><a class="headerlink" href="#configuracion-del-proyecto-settings-py" title="Enlazar permanentemente con este título">#</a></h3>
<p>Acceder desde la raiz del proyecto a la carpeta con el mismo nombre de este. Editar: <code class="docutils literal notranslate"><span class="pre">settings.py</span></code>:</p>
<ul class="simple">
<li><p>debug: <code class="docutils literal notranslate"><span class="pre">True</span></code> por defecto, mostrará errores en el navegador. <code class="docutils literal notranslate"><span class="pre">False</span></code> para evitar mostrarlos en producción.</p></li>
<li><p>ALLOWED_HOSTS: Un listado en blanco en el cual podemos escribir los dominios permitidos con los que mostrar la app.</p></li>
<li><p>INSTALLED_APPS: Listado donde se añaden las apps que se irán creando.</p></li>
<li><p>DATABASES: Diccionario con las bases de datos que se van a usar, por defecto una SQLite.</p></li>
<li><p>LANGUAGE_CODE: cambiar valor por <code class="docutils literal notranslate"><span class="pre">es</span></code> para tener el proyecto en español.</p></li>
<li><p>TIME_ZONE: Para zona horaria España, cambiar a <code class="docutils literal notranslate"><span class="pre">Europe/Madrid</span></code></p></li>
<li><p>STATIC_URL: Url donde se guardarán los archivos estáticos.</p></li>
<li><p>MEDIA_URL: Url donde se guardan los archivos multimedia (no existe por defecto).</p></li>
</ul>
</section>
<section id="arrancar-la-base-de-datos">
<h3><a class="toc-backref" href="#id5">Arrancar la base de datos</a><a class="headerlink" href="#arrancar-la-base-de-datos" title="Enlazar permanentemente con este título">#</a></h3>
<section id="trabajar-con-sqlite">
<h4><a class="toc-backref" href="#id6">Trabajar con SQLite</a><a class="headerlink" href="#trabajar-con-sqlite" title="Enlazar permanentemente con este título">#</a></h4>
<ul class="simple">
<li><p>Viene preparada por defecto:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">2</span>    <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
<span class="linenos">3</span>        <span class="s1">&#39;ENGINE&#39;</span><span class="p">:</span> <span class="s1">&#39;django.db.backends.sqlite3&#39;</span><span class="p">,</span>
<span class="linenos">4</span>        <span class="s1">&#39;NAME&#39;</span><span class="p">:</span> <span class="n">BASE_DIR</span> <span class="o">/</span> <span class="s1">&#39;db.sqlite3&#39;</span><span class="p">,</span>
<span class="linenos">5</span>    <span class="p">}</span>
<span class="linenos">6</span><span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Crear el CRUD inicial de Usuarios: <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">migrate</span></code></p></li>
</ul>
</section>
<section id="trabajar-con-mysql">
<h4><a class="toc-backref" href="#id7">Trabajar con MySQL</a><a class="headerlink" href="#trabajar-con-mysql" title="Enlazar permanentemente con este título">#</a></h4>
<ul class="simple">
<li><p>La configuración sería la siguiente:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos"> 2</span>    <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
<span class="linenos"> 3</span>        <span class="s1">&#39;ENGINE&#39;</span><span class="p">:</span> <span class="s1">&#39;django.db.backends.mysql&#39;</span><span class="p">,</span>
<span class="linenos"> 4</span>        <span class="s1">&#39;NAME&#39;</span><span class="p">:</span> <span class="s1">&#39;nombre_database&#39;</span><span class="p">,</span>
<span class="linenos"> 5</span>        <span class="s1">&#39;USER&#39;</span><span class="p">:</span> <span class="s1">&#39;usuario_database&#39;</span><span class="p">,</span>
<span class="linenos"> 6</span>        <span class="s1">&#39;PASSWORD&#39;</span><span class="p">:</span> <span class="s1">&#39;clave_database&#39;</span><span class="p">,</span>
<span class="linenos"> 7</span>        <span class="s1">&#39;HOST&#39;</span><span class="p">:</span> <span class="s1">&#39;localhost&#39;</span><span class="p">,</span>
<span class="linenos"> 8</span>        <span class="s1">&#39;PORT&#39;</span><span class="p">:</span> <span class="s1">&#39;3306&#39;</span><span class="p">,</span>
<span class="linenos"> 9</span>    <span class="p">}</span>
<span class="linenos">10</span><span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Del mismo modo se ejecuta la primera migración: <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">migrate</span></code></p></li>
</ul>
</section>
</section>
<section id="crear-un-administrador">
<h3><a class="toc-backref" href="#id8">Crear un Administrador</a><a class="headerlink" href="#crear-un-administrador" title="Enlazar permanentemente con este título">#</a></h3>
<ul class="simple">
<li><p>Una vez ejecutada la primera migración se genera un usuario ejecutando en terminal: <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">createsuperuser</span></code></p></li>
</ul>
</section>
<section id="crear-una-aplicacion">
<h3><a class="toc-backref" href="#id9">Crear una aplicación</a><a class="headerlink" href="#crear-una-aplicacion" title="Enlazar permanentemente con este título">#</a></h3>
<p>Django es un Framework modular, lo que quiere decir que iremos creando aplicaciones en el para gestionar distintas páginas y así poder reutilizar código.
* Crear app: <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">startapp</span> <span class="pre">nombre_de_tu_app</span></code>, esto nos genera una carpeta con los archivos esenciales para una app (views.py, models.py…)
* Añadir a la lista de apps en <code class="docutils literal notranslate"><span class="pre">settings.py</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">[</span>
<span class="linenos">2</span>    <span class="s1">&#39;django.contrib.admin&#39;</span><span class="p">,</span>
<span class="linenos">3</span>    <span class="s1">&#39;django.contrib.auth&#39;</span><span class="p">,</span>
<span class="linenos">4</span>    <span class="s1">&#39;django.contrib.contenttypes&#39;</span><span class="p">,</span>
<span class="linenos">5</span>    <span class="s1">&#39;django.contrib.sessions&#39;</span><span class="p">,</span>
<span class="linenos">6</span>    <span class="s1">&#39;django.contrib.messages&#39;</span><span class="p">,</span>
<span class="linenos">7</span>    <span class="s1">&#39;django.contrib.staticfiles&#39;</span><span class="p">,</span>
<span class="linenos">8</span>    <span class="s1">&#39;nombre_de_tu_app&#39;</span> <span class="c1"># Declaramos nuestra app en esta lista</span>
<span class="linenos">9</span><span class="p">]</span>
</pre></div>
</div>
</section>
</section>
<section id="rutas">
<h2><a class="toc-backref" href="#id10">Rutas</a><a class="headerlink" href="#rutas" title="Enlazar permanentemente con este título">#</a></h2>
<section id="rutas-principales-prueba-urls-py">
<h3><a class="toc-backref" href="#id11">Rutas principales (prueba/urls.py)</a><a class="headerlink" href="#rutas-principales-prueba-urls-py" title="Enlazar permanentemente con este título">#</a></h3>
<p>El archivo de rutas principal de Django se encuentra en la carpeta cuyo nombre es el del proyecto y se llama <code class="docutils literal notranslate"><span class="pre">urls.py</span></code>.</p>
<p>urls.py principal:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># las dos primeras líneas importan el panel de administración y la librería path para agregar rutas</span>
<span class="linenos">2</span><span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="linenos">3</span><span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">path</span>
<span class="linenos">4</span><span class="kn">from</span> <span class="nn">nombre_de_tu_app</span> <span class="kn">import</span> <span class="n">views</span> <span class="c1"># Este es el archivo de vista que importamos de la app creada anteriormente</span>
<span class="linenos">5</span>
<span class="linenos">6</span><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
<span class="linenos">7</span>    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;admin/&#39;</span><span class="p">,</span> <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">),</span>
<span class="linenos">8</span>    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;home/&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">home</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;home&#39;</span><span class="p">),</span> <span class="c1"># Definimos que &#39;&#39; (ruta raiz) apunte a la vista **home** y tenga el name &#39;home&#39; para luego usar un template tag de rutas.</span>
<span class="linenos">9</span><span class="p">]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Si en lugar de home/ definimos un string vacio esta vista se establecerá como la vista principal en cada aplicación</p>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>La primera ruta que se observa lleva hacia el panel de administración que viene ya creado de serie en Django</p>
</div>
<div class="admonition attention">
<p class="admonition-title">Atención</p>
<p>En los casos que se arranca el servidor y este da un fallo suele ser por dos razones,
la primera que no se haya importado la vista correspondiente y la segunda que no se haga
creado la función de vista en su archivo <code class="docutils literal notranslate"><span class="pre">views.py</span></code></p>
</div>
</section>
<section id="rutas-en-app-nombre-app-urls-py">
<h3><a class="toc-backref" href="#id12">Rutas en App (nombre_app/urls.py)</a><a class="headerlink" href="#rutas-en-app-nombre-app-urls-py" title="Enlazar permanentemente con este título">#</a></h3>
<p>Es posible generar otros archivos de rutas <code class="docutils literal notranslate"><span class="pre">urls.py</span></code> dentro de cada aplicación para gestionar sus rutas internas.</p>
<ul class="simple">
<li><p>En el archivo de rutas principal (prueba/urls.py):</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="linenos">2</span><span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">path</span><span class="p">,</span> <span class="n">include</span> <span class="c1"># Cargamos la librería include</span>
<span class="linenos">3</span>
<span class="linenos">4</span><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
<span class="linenos">5</span>    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;admin/&#39;</span><span class="p">,</span> <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">),</span>
<span class="linenos">6</span>    <span class="c1"># importamos el archivo urls de nuestra app:</span>
<span class="linenos">7</span>    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s1">&#39;nombre_de_tu_app.urls&#39;</span><span class="p">))</span>
<span class="linenos">8</span><span class="p">]</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Se crea el archivo en la ruta de la app correspondiente: (nombre_de_tu_app/urls.py):</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">path</span>
<span class="linenos">2</span><span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span> <span class="k">as</span> <span class="n">nombre_de_tu_app</span>
<span class="linenos">3</span>
<span class="linenos">4</span><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
<span class="linenos">5</span>    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">nombre_de_tu_app</span><span class="o">.</span><span class="n">home</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;home&#39;</span><span class="p">),</span>
<span class="linenos">6</span>    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;sobremi/&#39;</span><span class="p">,</span> <span class="n">nombre_de_tu_app</span><span class="o">.</span><span class="n">about</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;sobremi&#39;</span><span class="p">),</span>
<span class="linenos">7</span><span class="p">]</span>
</pre></div>
</div>
<p>En este archivo se gestionarán las rutas hacia las vistas de esta app en concreto.</p>
</section>
<section id="rutas-con-parametros">
<h3><a class="toc-backref" href="#id13">rutas con parámetros</a><a class="headerlink" href="#rutas-con-parametros" title="Enlazar permanentemente con este título">#</a></h3>
<ul class="simple">
<li><p>Las rutas con parámetros:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">path</span>
<span class="linenos">2</span><span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span> <span class="k">as</span> <span class="n">nombre_de_tu_app</span>
<span class="linenos">3</span>
<span class="linenos">4</span><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
<span class="linenos">5</span>    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">nombre_de_tu_app</span><span class="o">.</span><span class="n">home</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;home&#39;</span><span class="p">),</span>
<span class="linenos">6</span>    <span class="c1"># despues del slash pasamos entre símbolos menor y mayor que el tipo de variable y el parámetro. si no lleva nada lo reconoce como cadena</span>
<span class="linenos">7</span>    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;sobremi/&lt;int:id_entrada&gt;&#39;</span><span class="p">,</span> <span class="n">nombre_de_tu_app</span><span class="o">.</span><span class="n">about</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;sobremi&#39;</span><span class="p">),</span>
<span class="linenos">8</span><span class="p">]</span>
</pre></div>
</div>
<ul class="simple">
<li><p>La ruta que recibe parámetros por ejemplo sería: <a class="reference external" href="http://localhost:5000/sobremi/19">http://localhost:5000/sobremi/19</a></p></li>
<li><p>Procesar parámetros desde la vista:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>
<span class="linenos">2</span><span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Prueba</span>
<span class="linenos">3</span>
<span class="linenos">4</span><span class="c1"># la función recibe por parámetros la id de la entrada:</span>
<span class="linenos">5</span><span class="k">def</span> <span class="nf">about</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">id_entrada</span><span class="p">):</span>
<span class="linenos">6</span>    <span class="c1"># este parámetro lo podemos usar por ejemplo para encontrar una entrada ya que django por defecto les asigna un id</span>
<span class="linenos">7</span>    <span class="n">entrada</span> <span class="o">=</span> <span class="n">Prueba</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">id_entrada</span><span class="p">)</span>
<span class="linenos">8</span>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;nombre_de_tu_app/about.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;entrada&#39;</span><span class="p">:</span><span class="n">entrada</span><span class="p">})</span>
</pre></div>
</div>
</section>
<section id="rutas-de-cbv">
<h3><a class="toc-backref" href="#id14">Rutas de CBV</a><a class="headerlink" href="#rutas-de-cbv" title="Enlazar permanentemente con este título">#</a></h3>
<p>Si trabajamos con <strong>Vistas Basadas en Clases (CBV)</strong> las rutas son distintas:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">path</span>
<span class="linenos">2</span><span class="c1"># Importamos las vistas:</span>
<span class="linenos">3</span><span class="kn">from</span> <span class="nn">.views</span> <span class="kn">import</span> <span class="n">HomePageView</span>
<span class="linenos">4</span>
<span class="linenos">5</span><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
<span class="linenos">6</span>    <span class="c1"># Devolvemos las urls con el metodo as_view para que las muestre como tal:</span>
<span class="linenos">7</span>    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">HomePageView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;home&quot;</span><span class="p">),</span>
<span class="linenos">8</span><span class="p">]</span>
</pre></div>
</div>
</section>
</section>
<section id="vistas">
<h2><a class="toc-backref" href="#id15">Vistas</a><a class="headerlink" href="#vistas" title="Enlazar permanentemente con este título">#</a></h2>
<p>Existen dos formas de crear vistas en Django, las <strong>FBV</strong> (Function-based Views) y las <strong>CBV</strong> (Class-based Views).</p>
<section id="fbv-function-based-views">
<h3><a class="toc-backref" href="#id16">FBV (Function-Based Views)</a><a class="headerlink" href="#fbv-function-based-views" title="Enlazar permanentemente con este título">#</a></h3>
<p>Vistas basadas en funciones:</p>
<ul class="simple">
<li><p>Devolver respuesta HTML con <strong>HttpResponse</strong>:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">HttpResponse</span> <span class="c1"># el modulo HttpResponse carga una respuesta HTML directamente sin plantillas.</span>
<span class="linenos">2</span>
<span class="linenos">3</span><span class="c1"># Creamos la función que gestionará la vista home definida como raiz en urls.py:</span>
<span class="linenos">4</span><span class="k">def</span> <span class="nf">home</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<span class="linenos">5</span>    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s2">&quot;&lt;h1&gt;Título de prueba&lt;/h1&gt;&lt;h2&gt;Subtítulo&lt;/h2&gt;&quot;</span><span class="p">)</span> <span class="c1"># esta va a retornar una respuesta html</span>
</pre></div>
</div>
<p>Si nos vamos al navegador y ejecutamos la raiz veremos que el mensaje de bienvenida cambió por este último.</p>
<ul class="simple">
<li><p>Devolver una plantilla HTML con <strong>Render</strong>:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># importamos render que suele venir importado por defecto:</span>
<span class="linenos">2</span><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>
<span class="linenos">3</span>
<span class="linenos">4</span><span class="c1"># creamos una función para gestionar los datos de vista:</span>
<span class="linenos">5</span><span class="k">def</span> <span class="nf">home</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<span class="linenos">6</span>    <span class="c1"># dentro de esta vista retornamos render y le pasamos por el segundo parámetro la plantilla que vamos a usar:</span>
<span class="linenos">7</span>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;nombre_de_tu_app/home.html&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition attention">
<p class="admonition-title">Atención</p>
<p>Es probable tener un error Template does not exist, se debe a que se ha creado aun el template,
o que no se ha añadido la app a INSTALLED_APPS o simplemente requiere reiniciar el servidor
para que funcione.</p>
</div>
</section>
<section id="cbv-class-based-views">
<h3><a class="toc-backref" href="#id17">CBV (Class-Based Views)</a><a class="headerlink" href="#cbv-class-based-views" title="Enlazar permanentemente con este título">#</a></h3>
<p>Vistas basadas en Clases, existen varias:</p>
<section id="templateview">
<h4><a class="toc-backref" href="#id18">TemplateView</a><a class="headerlink" href="#templateview" title="Enlazar permanentemente con este título">#</a></h4>
<p>Clase de vista estandar, se utiliza comunmente para renderizar templates:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>
<span class="linenos">2</span><span class="c1"># Importamos la librería templateview:</span>
<span class="linenos">3</span><span class="kn">from</span> <span class="nn">django.views.generic.base</span> <span class="kn">import</span> <span class="n">TemplateView</span>
<span class="linenos">4</span>
<span class="linenos">5</span><span class="c1"># Utilizamos las de tipo templateview para devolver un template:</span>
<span class="linenos">6</span><span class="k">class</span> <span class="nc">HomePageView</span><span class="p">(</span><span class="n">TemplateView</span><span class="p">):</span>
<span class="linenos">7</span>    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">&#39;nombre_de_tu_app/home.html&#39;</span>
</pre></div>
</div>
</section>
<section id="listview">
<h4><a class="toc-backref" href="#id19">ListView</a><a class="headerlink" href="#listview" title="Enlazar permanentemente con este título">#</a></h4>
<p>Con ListView podemos devolver una tabla de la base de datos de forma sencilla:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>
<span class="linenos">2</span><span class="c1"># Importamos el listview y la base de datos:</span>
<span class="linenos">3</span><span class="kn">from</span> <span class="nn">django.views.generic.list</span> <span class="kn">import</span> <span class="n">ListView</span>
<span class="linenos">4</span><span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Page</span>
<span class="linenos">5</span>
<span class="linenos">6</span><span class="c1"># Ahora creamos la clase de tipo ListView:</span>
<span class="linenos">7</span><span class="k">class</span> <span class="nc">PageListView</span><span class="p">(</span><span class="n">ListView</span><span class="p">):</span>
<span class="linenos">8</span>    <span class="n">model</span> <span class="o">=</span> <span class="n">Page</span> <span class="c1"># Gestionará el modelo page</span>
<span class="linenos">9</span>    <span class="n">paginate_by</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1"># así de sencillo se paginan resultados.</span>
</pre></div>
</div>
<p>De esta forma tenemos un listado en el template listo para recorrer usando el bucle sobre el valor object_list <code class="docutils literal notranslate"><span class="pre">{%</span> <span class="pre">for</span> <span class="pre">pagina</span> <span class="pre">in</span> <span class="pre">object_list</span> <span class="pre">%}</span></code></p>
<div class="admonition attention">
<p class="admonition-title">Atención</p>
<p>Para que funcione esta vista y encuentre su template por defecto sería <strong>page_list.html</strong> y la colocamos dentro de la carpeta <code class="docutils literal notranslate"><span class="pre">templates/nombre_de_tu_app/</span></code></p>
</div>
</section>
<section id="detailview">
<h4><a class="toc-backref" href="#id20">DetailView</a><a class="headerlink" href="#detailview" title="Enlazar permanentemente con este título">#</a></h4>
<p>Con la vista detalle recuperamos un elemento de la base de datos para visualizarlo, veamos views.py:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Importamos el detailview:</span>
<span class="linenos">2</span><span class="kn">from</span> <span class="nn">django.views.generic.detail</span> <span class="kn">import</span> <span class="n">DetailView</span>
<span class="linenos">3</span><span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Page</span>
<span class="linenos">4</span>
<span class="linenos">5</span>
<span class="linenos">6</span><span class="c1"># Ahora vamos a integrar la clase de pagina simple con el detailview:</span>
<span class="linenos">7</span><span class="k">class</span> <span class="nc">PageDetailView</span><span class="p">(</span><span class="n">DetailView</span><span class="p">):</span>
<span class="linenos">8</span>    <span class="n">model</span> <span class="o">=</span> <span class="n">Page</span> <span class="c1"># cargamos el modelo Page</span>
</pre></div>
</div>
<p>En la ruta deberemos asignar el parámetro <code class="docutils literal notranslate"><span class="pre">&lt;int:pk&gt;</span></code> para poder recibir el id del elemento.</p>
<div class="admonition attention">
<p class="admonition-title">Atención</p>
<p>Debemos crear el template dentro de templates/nombre_de_tu_app/ con el nombre page_detail.html, ahora solo falta imprimir los datos usando el template tag {{page}}</p>
</div>
</section>
<section id="createview">
<h4><a class="toc-backref" href="#id21">CreateView</a><a class="headerlink" href="#createview" title="Enlazar permanentemente con este título">#</a></h4>
<p>Como su nombre indica, es la vista para crear elementos, vamos a probarla en views.py:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># Importamos CreateView:</span>
<span class="linenos"> 2</span><span class="kn">from</span> <span class="nn">django.views.generic.edit</span> <span class="kn">import</span> <span class="n">CreateView</span>
<span class="linenos"> 3</span><span class="c1"># e importamos la librería para hacer redirecciones:</span>
<span class="linenos"> 4</span><span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">reverse_lazy</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Page</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="c1"># Y creamos la vista con CreateView para crear registros:</span>
<span class="linenos"> 9</span><span class="k">class</span> <span class="nc">PageCreate</span><span class="p">(</span><span class="n">CreateView</span><span class="p">):</span>
<span class="linenos">10</span>    <span class="n">model</span> <span class="o">=</span> <span class="n">Page</span> <span class="c1"># Cargamos el modelo.</span>
<span class="linenos">11</span>    <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;content&#39;</span><span class="p">,</span> <span class="s1">&#39;order&#39;</span><span class="p">]</span> <span class="c1"># Y ahora añadimos los campos que vamos a permitir que se puedan crear</span>
<span class="linenos">12</span>    <span class="c1"># Opcionalmente hacemos un reverse_lazy que retorna a la página que le indicamos:</span>
<span class="linenos">13</span>    <span class="n">success_url</span> <span class="o">=</span> <span class="n">reverse_lazy</span><span class="p">(</span><span class="s1">&#39;pages:pages&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Con esto solo nos falta el template llamado page_create.html y utilizar un formulario que suba dichos campos.</p>
</section>
<section id="updateview">
<h4><a class="toc-backref" href="#id22">UpdateView</a><a class="headerlink" href="#updateview" title="Enlazar permanentemente con este título">#</a></h4>
<p>Esta vista sirve para actualizar registros, hay que pasarle un pk para poder editar la página correcta.</p>
<ul class="simple">
<li><p>Editamos views.py:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># Importamos el update:</span>
<span class="linenos"> 2</span><span class="kn">from</span> <span class="nn">django.views.generic.edit</span> <span class="kn">import</span> <span class="n">UpdateView</span>
<span class="linenos"> 3</span><span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">reverse_lazy</span>
<span class="linenos"> 4</span><span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Page</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="c1"># Ahora creamos la vista update:</span>
<span class="linenos"> 7</span><span class="k">class</span> <span class="nc">PageUpdate</span><span class="p">(</span><span class="n">UpdateView</span><span class="p">):</span>
<span class="linenos"> 8</span>    <span class="n">model</span> <span class="o">=</span> <span class="n">Page</span>
<span class="linenos"> 9</span>    <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;content&#39;</span><span class="p">,</span> <span class="s1">&#39;order&#39;</span><span class="p">]</span>
<span class="linenos">10</span>    <span class="c1"># Ahora le pasamos el sufijo que tendrá la página (page_update_form.html):</span>
<span class="linenos">11</span>    <span class="n">template_name_suffix</span> <span class="o">=</span> <span class="s1">&#39;_update_form&#39;</span>
<span class="linenos">12</span>
<span class="linenos">13</span>    <span class="c1"># Ahora vamos a retornar al formulario una vez terminada la edición esta vez necesariamente con un método específico de django:</span>
<span class="linenos">14</span>    <span class="k">def</span> <span class="nf">get_success_url</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># Le pasamos por argumenoto la id:</span>
<span class="linenos">15</span>    <span class="k">return</span> <span class="n">reverse_lazy</span><span class="p">(</span><span class="s1">&#39;pages:update&#39;</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">id</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;?ok&#39;</span> <span class="c1"># Le pasamos por parámetros un valor ok para verificarlo en el template</span>
</pre></div>
</div>
<p>De este modo solo nos falta el archivo page_update.html y en la ruta pasarle un parámetro con el nombre &lt;int:pk&gt;, en el template ponemos un formulario tal cual como en CreateView.</p>
</section>
<section id="deleteview">
<h4><a class="toc-backref" href="#id23">DeleteView</a><a class="headerlink" href="#deleteview" title="Enlazar permanentemente con este título">#</a></h4>
<p>Sirve para borrar entradas, funciona de un modo similar a UpdateView, veamos views.py:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">django.views.generic.edit</span> <span class="kn">import</span> <span class="n">DeleteView</span>
<span class="linenos"> 2</span><span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">reverse_lazy</span>
<span class="linenos"> 3</span><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Page</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="c1"># Creamos la vista delete:</span>
<span class="linenos"> 8</span><span class="k">class</span> <span class="nc">PageDelete</span><span class="p">(</span><span class="n">DeleteView</span><span class="p">):</span>
<span class="linenos"> 9</span>    <span class="n">model</span> <span class="o">=</span> <span class="n">Page</span>
<span class="linenos">10</span>    <span class="n">success_url</span> <span class="o">=</span> <span class="n">reverse_lazy</span><span class="p">(</span><span class="s1">&#39;pages:pages&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Con esto le pasamos a la ruta un parámetro tipo &lt;int:pk&gt; y crear el template DeleteView.as_view()</p>
</section>
<section id="pasarle-un-formulario-a-una-cbv">
<h4><a class="toc-backref" href="#id24">Pasarle un formulario a una CBV</a><a class="headerlink" href="#pasarle-un-formulario-a-una-cbv" title="Enlazar permanentemente con este título">#</a></h4>
<p>Para pasarle un formulario a un CBV hacemos lo siguiente en views.py:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">django.views.generic.edit</span> <span class="kn">import</span> <span class="n">CreateView</span>
<span class="linenos"> 2</span><span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">reverse_lazy</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>
<span class="linenos"> 5</span><span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Page</span>
<span class="linenos"> 6</span><span class="c1"># Importamos el formulario de forms:</span>
<span class="linenos"> 7</span><span class="kn">from</span> <span class="nn">.forms</span> <span class="kn">import</span> <span class="n">PageForm</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="k">class</span> <span class="nc">PageCreate</span><span class="p">(</span><span class="n">CreateView</span><span class="p">):</span>
<span class="linenos">10</span>    <span class="n">model</span> <span class="o">=</span> <span class="n">Page</span>
<span class="linenos">11</span>    <span class="n">form_class</span> <span class="o">=</span> <span class="n">PageForm</span> <span class="c1"># Asignamos el formulario que vamos a utilizar</span>
<span class="linenos">12</span>    <span class="n">success_url</span> <span class="o">=</span> <span class="n">reverse_lazy</span><span class="p">(</span><span class="s1">&#39;pages:pages&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="crear-un-nuevo-contexto">
<h4><a class="toc-backref" href="#id25">Crear un nuevo contexto</a><a class="headerlink" href="#crear-un-nuevo-contexto" title="Enlazar permanentemente con este título">#</a></h4>
<p>Este concepto se resume en la manera de exportar datos desde las vistas CBV al Template y este sería el modo:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>
<span class="linenos"> 2</span><span class="kn">from</span> <span class="nn">django.views.generic.base</span> <span class="kn">import</span> <span class="n">TemplateView</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="k">class</span> <span class="nc">HomePageView</span><span class="p">(</span><span class="n">TemplateView</span><span class="p">):</span>
<span class="linenos"> 5</span>    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">&#39;core/home.html&#39;</span>
<span class="linenos"> 6</span>    <span class="c1"># Podemos pasarle valores a la vista a través de un diccionario de contexto con un método específico:</span>
<span class="linenos"> 7</span>    <span class="k">def</span> <span class="nf">get_context_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos"> 8</span>        <span class="c1"># Cargamos del padre la estructura del diccionario:</span>
<span class="linenos"> 9</span>        <span class="n">context</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_context_data</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="linenos">10</span>        <span class="c1"># Y ahora podemos grabar por ejemplo un título:</span>
<span class="linenos">11</span>        <span class="n">context</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Título de mi web&#39;</span>
<span class="linenos">12</span>        <span class="c1"># La devolvemos al Template para que pueda usarlo:</span>
<span class="linenos">13</span>        <span class="k">return</span> <span class="n">context</span>
</pre></div>
</div>
<p>Imagina ahora que queremos usar ese contexto en un título del template, pues escribimos <code class="docutils literal notranslate"><span class="pre">&lt;h1&gt;{{titulo}}&lt;/h1&gt;</span></code> y listo.</p>
</section>
<section id="recuperar-datos-de-post-o-get">
<h4><a class="toc-backref" href="#id26">Recuperar datos de POST o GET</a><a class="headerlink" href="#recuperar-datos-de-post-o-get" title="Enlazar permanentemente con este título">#</a></h4>
<p>Para recuperar datos desde GET o POST utilizamos la función con su nombre que viene ya preparada en la clase superior:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Prueba</span>
<span class="linenos"> 2</span><span class="kn">from</span> <span class="nn">django.views.generic</span> <span class="kn">import</span> <span class="n">TemplateView</span>
<span class="linenos"> 3</span><span class="kn">from</span> <span class="nn">.forms</span> <span class="kn">import</span> <span class="n">ContactoForm</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="k">class</span> <span class="nc">RegistroView</span><span class="p">(</span><span class="n">TemplateView</span><span class="p">):</span>
<span class="linenos"> 6</span>    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">&#39;nombre_de_tu_app/index.html&#39;</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span>    <span class="c1"># Se utiliza la función predefinida llamada post o get con los parámetros que vemos:</span>
<span class="linenos"> 9</span>    <span class="k">def</span> <span class="nf">post</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos">10</span>        <span class="c1"># guardamos el formulario en una variable con los datos rellenos:</span>
<span class="linenos">11</span>        <span class="n">form</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">form_class</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">)</span>
<span class="linenos">12</span>        <span class="c1"># comprobamos que sea válido:</span>
<span class="linenos">13</span>        <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
<span class="linenos">14</span>            <span class="c1"># preparamos los datos para guardar:</span>
<span class="linenos">15</span>            <span class="n">registro</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">commit</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="linenos">16</span>            <span class="c1"># podemos editar algun dato por el camino:</span>
<span class="linenos">17</span>            <span class="n">registro</span><span class="o">.</span><span class="n">fecha_creacion</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">)</span>
<span class="linenos">18</span>            <span class="c1"># y guardamos el registro en el modelo:</span>
<span class="linenos">19</span>            <span class="n">registro</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="linenos">20</span>
<span class="linenos">21</span>            <span class="c1"># regresamos a la página de vuelta:</span>
<span class="linenos">22</span>            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;home&#39;</span><span class="p">))</span>
<span class="linenos">23</span>        <span class="k">else</span><span class="p">:</span>
<span class="linenos">24</span>            <span class="n">form</span> <span class="o">=</span> <span class="n">ContactoForm</span><span class="p">()</span>
</pre></div>
</div>
<p>De este modo una vez recibe datos los almacena en el modelo.</p>
</section>
</section>
<section id="decoradores">
<h3><a class="toc-backref" href="#id27">Decoradores</a><a class="headerlink" href="#decoradores" title="Enlazar permanentemente con este título">#</a></h3>
<p>Los decoradores sirven para hacer modificaciones en las vistas, como por ejemplo definir si una url la puede ver solo usuarios registrados o si es del staff:</p>
<ul class="simple">
<li><p>Decoradores en CBV:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># Se le pasa el decorador a la clase directamente:</span>
<span class="linenos"> 2</span><span class="nd">@method_decorator</span><span class="p">(</span><span class="n">login_required</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;dispatch&#39;</span><span class="p">)</span>
<span class="linenos"> 3</span><span class="k">class</span> <span class="nc">ProfileUpdate</span><span class="p">(</span><span class="n">TemplateView</span><span class="p">):</span>
<span class="linenos"> 4</span>    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">&#39;registration/profile_form.html&#39;</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="c1"># podemos definir si es un usuario registrado o si solo puede acceder el staff</span>
<span class="linenos"> 7</span><span class="nd">@method_decorator</span><span class="p">(</span><span class="n">staff_member_required</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;dispatch&#39;</span><span class="p">)</span> <span class="c1"># Para que el decorador de metodos sepa cual es el que tiene que decorar lo asignamos con un parámetro name</span>
<span class="linenos"> 8</span><span class="k">class</span> <span class="nc">PageCreate</span><span class="p">(</span><span class="n">CreateView</span><span class="p">):</span>
<span class="linenos"> 9</span>    <span class="n">model</span> <span class="o">=</span> <span class="n">Page</span>
<span class="linenos">10</span>    <span class="n">form_class</span> <span class="o">=</span> <span class="n">PageForm</span>
<span class="linenos">11</span>    <span class="n">success_url</span> <span class="o">=</span> <span class="n">reverse_lazy</span><span class="p">(</span><span class="s1">&#39;pages:pages&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Añadimos lo siguiente al final de settings.py para definir hacia donde irá para inciar sesión:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Este es el path al que queremos que redireccione:</span>
<span class="linenos">2</span><span class="n">LOGIN_REDIRECT_URL</span> <span class="o">=</span> <span class="s1">&#39;pages:pages&#39;</span>
<span class="linenos">3</span><span class="n">LOGOUT_REDIRECT_URL</span> <span class="o">=</span> <span class="s1">&#39;home&#39;</span>
</pre></div>
</div>
</section>
</section>
<section id="middleware-en-django">
<h2><a class="toc-backref" href="#id28">Middleware en Django</a><a class="headerlink" href="#middleware-en-django" title="Enlazar permanentemente con este título">#</a></h2>
<p>Los Middlewares se utilizan para controlar como se procesa la información, estos middlewares se ejecutan de forma global antes o despues de cada petición.
Por defecto django cuenta con al menos cuatro middlewares: SecurityMiddleware, SessionMiddleware, CommonMiddleware y AuthenticationMiddleware.
Los middlewares se declaran en <strong>settings.py</strong> en la constante <strong>MIDDLEWARE</strong></p>
<ul class="simple">
<li><p>SecurityMiddleware: Intenta garantizar la seguridad en la aplicación evitanto ataques XSS.</p></li>
<li><p>SessionMiddleware: Accede a la cookie de sesión y define donde se guardan las sesiones.</p></li>
<li><p>CommomMiddleware: Se encarga de normalizar las direcciones añadiendo www o / al final.</p></li>
<li><p>CsrfViewMiddleware: Sirve para garantizar que se cumple el CSRF_TOKEN.</p></li>
<li><p>AuthenticationMiddleware: Sirve para conseguir el usuario de la petición y añadirlo al request.</p></li>
<li><p>MessageMiddleware: Especialmente usado para mensajes flash, aunque ya se delegan sobre todo al Frontend.</p></li>
<li><p>XFrameOptionMiddleware: Evita errores de X-Content o Iframes y ataques click-jacking</p></li>
</ul>
<section id="crear-custom-middleware">
<h3><a class="toc-backref" href="#id29">Crear Custom Middleware</a><a class="headerlink" href="#crear-custom-middleware" title="Enlazar permanentemente con este título">#</a></h3>
<ol class="arabic simple">
<li><p>Dentro de una App se crea un archivo <strong>middleware.py</strong> (cada app tiene su propio archivo o también se puede sacar en la raiz):</p></li>
<li><p>Este sería el comportamiento base de un middleware:</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># Se importa el modulo que llama a las peticiones:</span>
<span class="linenos"> 2</span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Callable</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="c1"># Se crea una clase para el middleware:</span>
<span class="linenos"> 5</span><span class="k">class</span> <span class="nc">NombreMiddleware</span><span class="p">:</span>
<span class="linenos"> 6</span>    <span class="c1"># en el constructor recibirá la respuesta con Callable:</span>
<span class="linenos"> 7</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">get_response</span><span class="p">:</span> <span class="n">Callable</span><span class="p">):</span>
<span class="linenos"> 8</span>        <span class="c1"># guardamos en el atributo de clase la petición:</span>
<span class="linenos"> 9</span>        <span class="bp">self</span><span class="o">.</span><span class="n">get_response</span> <span class="o">=</span> <span class="n">get_response</span>
<span class="linenos">10</span>
<span class="linenos">11</span>
<span class="linenos">12</span>    <span class="c1"># se genera el metodo de llamada:</span>
<span class="linenos">13</span>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
<span class="linenos">14</span>        <span class="c1"># guardamos la respuesta de la petición:</span>
<span class="linenos">15</span>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_response</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<span class="linenos">16</span>
<span class="linenos">17</span>
<span class="linenos">18</span>        <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Activar middleware en <strong>settings.py</strong>:</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="n">MIDDLEWARE</span> <span class="o">=</span> <span class="p">[</span>
<span class="linenos"> 2</span>    <span class="s1">&#39;django.middleware.security.SecurityMiddleware&#39;</span><span class="p">,</span>
<span class="linenos"> 3</span>    <span class="s1">&#39;django.contrib.sessions.middleware.SessionMiddleware&#39;</span><span class="p">,</span>
<span class="linenos"> 4</span>    <span class="s1">&#39;django.middleware.common.CommonMiddleware&#39;</span><span class="p">,</span>
<span class="linenos"> 5</span>    <span class="s1">&#39;django.middleware.csrf.CsrfViewMiddleware&#39;</span><span class="p">,</span>
<span class="linenos"> 6</span>    <span class="s1">&#39;django.contrib.auth.middleware.AuthenticationMiddleware&#39;</span><span class="p">,</span>
<span class="linenos"> 7</span>    <span class="s1">&#39;django.contrib.messages.middleware.MessageMiddleware&#39;</span><span class="p">,</span>
<span class="linenos"> 8</span>    <span class="s1">&#39;django.middleware.clickjacking.XFrameOptionsMiddleware&#39;</span><span class="p">,</span>
<span class="linenos"> 9</span>    <span class="s1">&#39;core.middleware.NombreMiddleware&#39;</span> <span class="c1"># añadir el nuevo middleware creado</span>
<span class="linenos">10</span><span class="p">]</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Ahora se va a crear un custom middleware que filtre direcciones IP:</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># instalamos para el ejemplo django-ipware:</span>
<span class="linenos"> 2</span><span class="kn">from</span> <span class="nn">ipware</span> <span class="kn">import</span> <span class="n">get_client_ip</span>
<span class="linenos"> 3</span><span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponse</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="c1"># se asigna el nombre del middleware:</span>
<span class="linenos"> 6</span><span class="k">class</span> <span class="nc">IpValidMiddleware</span><span class="p">:</span>
<span class="linenos"> 7</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">get_response</span><span class="p">):</span>
<span class="linenos"> 8</span>        <span class="bp">self</span><span class="o">.</span><span class="n">get_response</span> <span class="o">=</span> <span class="n">get_response</span>
<span class="linenos"> 9</span>        <span class="c1"># Creamos la lista negra de ips:</span>
<span class="linenos">10</span>        <span class="bp">self</span><span class="o">.</span><span class="n">black_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">]</span>
<span class="linenos">11</span>
<span class="linenos">12</span>
<span class="linenos">13</span>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
<span class="linenos">14</span>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_response</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<span class="linenos">15</span>
<span class="linenos">16</span>        <span class="c1"># recuperamos la ip de la request en dos variables (obligatorio aunque se use solo una):</span>
<span class="linenos">17</span>        <span class="n">ip</span><span class="p">,</span> <span class="n">is_routable</span> <span class="o">=</span> <span class="n">get_client_ip</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<span class="linenos">18</span>
<span class="linenos">19</span>        <span class="c1"># comprobamos si esta en lista negra y cambiamos la response en caso de que sea así:</span>
<span class="linenos">20</span>        <span class="k">if</span> <span class="n">ip</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">black_list</span><span class="p">:</span>
<span class="linenos">21</span>            <span class="c1"># tiramos de error 404:</span>
<span class="linenos">22</span>            <span class="n">response</span> <span class="o">=</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;Bad request&#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="mi">404</span><span class="p">)</span>
<span class="linenos">23</span>
<span class="linenos">24</span>        <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
</section>
</section>
<section id="templates">
<h2><a class="toc-backref" href="#id30">Templates</a><a class="headerlink" href="#templates" title="Enlazar permanentemente con este título">#</a></h2>
<p>Las plantillas son las que muestran el sitio web mediante etiquetas HTML y también imprimen resultados que gestiona el servidor con <strong>Template Tags</strong>.</p>
<ul class="simple">
<li><p>Para comenzar a utilizar templates creamos una carpeta llamada <strong>templates</strong> en el interior de la carpeta de nuestra app y dentro de templates otro directorio con el nombre de la app. (nombre_de_tu_app/templates/nombre_de_tu_app)</p></li>
<li><p>Ahora creamos un archivo html por ejemplo home.html que cargará la página de inicio:</p></li>
</ul>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;es&quot;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;UTF-8&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;viewport&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Página de prueba<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Bienvenido a mi página de prueba<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>Aquí haremos pruebas varias<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</div>
<div class="admonition attention">
<p class="admonition-title">Atención</p>
<p>Para que funcione debemos tener listo el render que devuelve este archivo html y al abrir el navegador se mostrará correctamente.</p>
</div>
<section id="template-tags">
<h3><a class="toc-backref" href="#id31">Template Tags</a><a class="headerlink" href="#template-tags" title="Enlazar permanentemente con este título">#</a></h3>
<p>Los Template Tags son un tipo de etiquetas especiales en Django que se utilizan en las plantillas para ejecutar respuestas backend.</p>
<p>Estas etiquetas suelen tener dos tipos de estructuras: <code class="docutils literal notranslate"><span class="pre">{%</span> <span class="pre">instrucción</span> <span class="pre">%}</span></code> o <code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">datos</span> <span class="pre">}}</span></code> según el tipo de tarea que vayamos a ejecutar.</p>
<section id="template-tag-base">
<h4><a class="toc-backref" href="#id32">Template tag base</a><a class="headerlink" href="#template-tag-base" title="Enlazar permanentemente con este título">#</a></h4>
<p>Una buena práctica para no repetir código en plantillas es coger todo el contenido común y almacenarlo en una plantilla base:</p>
<ul class="simple">
<li><p>Entramos en la carpeta <code class="docutils literal notranslate"><span class="pre">nombre_de_tu_app/templates/nombre_de_tu_app</span></code> y creamos un archivo llamado base.html donde copiaremos el contenido común:</p></li>
<li><p>Ahora vamos a quitar el código de home.html y lo pegamos en base.html:</p></li>
</ul>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="linenos"> 2</span><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;es&quot;</span><span class="p">&gt;</span>
<span class="linenos"> 3</span><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="linenos"> 4</span>    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;UTF-8&quot;</span><span class="p">&gt;</span>
<span class="linenos"> 5</span>    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;viewport&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="p">&gt;</span>
<span class="linenos"> 6</span>    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Página de prueba<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="linenos"> 7</span><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="linenos"> 8</span><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="linenos"> 9</span>    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Bienvenido a mi página de prueba<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="linenos">10</span>    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>Aquí haremos pruebas varias<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
<span class="linenos">11</span>
<span class="linenos">12</span>    <span class="cm">&lt;!-- Justo aquí enmedio utilizaremos el template tag base para extender una parte de otra plantilla  --&gt;</span>
<span class="linenos">13</span>    {% block cuerpo %}{% endblock %}
<span class="linenos">14</span>
<span class="linenos">15</span>    <span class="p">&lt;</span><span class="nt">footer</span><span class="p">&gt;</span>Piptocode, hecho con cariño y para amantes de la programación<span class="p">&lt;/</span><span class="nt">footer</span><span class="p">&gt;</span>
<span class="linenos">16</span><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="linenos">17</span><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Finalmente vamos a usar home.html como una plantilla de extensión con su propio código:</p></li>
</ul>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="cm">&lt;!-- llamamos el template tag con extends: --&gt;</span>
<span class="linenos">2</span>{% extends &#39;nombre_de_tu_app/base.html&#39; %}
<span class="linenos">3</span>
<span class="linenos">4</span><span class="cm">&lt;!-- Utilizamos el block content para definir donde irá el contenido de la pagina home respecto a la plantilla base --&gt;</span>
<span class="linenos">5</span>{% block cuerpo %}
<span class="linenos">6</span>    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>Portada<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
<span class="linenos">7</span>    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Esta es la página principal del sitio y utiliza una plantilla base para el contenido estático<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="linenos">8</span>{% endblock %}
</pre></div>
</div>
<p>Siguiendo este patrón podemos reutilizar el código base de la web en nuevas páginas o incluso nuevas apps de Django.</p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>En relación a extends podemos cargar cualquier plantilla a modo de fragmento, por ejemplo para ordenar css inline, un sidebar u otros elementos dinámicos que
hagan falta en el día a día. El objetivo es reducir el número de lineas HTML aumentando la cantidad de plantillas identificables y reutilizables.</p>
</div>
</section>
<section id="template-tag-url">
<h4><a class="toc-backref" href="#id33">Template tag url</a><a class="headerlink" href="#template-tag-url" title="Enlazar permanentemente con este título">#</a></h4>
<p>Con este template tag podemos establecer vínculos a otras páginas enlazando los names del archivo de rutas.</p>
<p>¿recuerdas las líneas que escribimos dentro de urls.py? <code class="docutils literal notranslate"><span class="pre">path('',</span> <span class="pre">views.home,</span> <span class="pre">name</span> <span class="pre">=</span> <span class="pre">'home'),</span></code>, el path recibe tres valores, la ruta del navegador, la ubicación de la vista y por último el nombre de la ruta,
este tercer valor es el que utilizamos con el template tag <strong>url</strong></p>
<ul class="simple">
<li><p>vamos a editar el archivo base.html para añadir un menú de navegación:</p></li>
</ul>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="linenos"> 2</span><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;es&quot;</span><span class="p">&gt;</span>
<span class="linenos"> 3</span><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="linenos"> 4</span>    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;UTF-8&quot;</span><span class="p">&gt;</span>
<span class="linenos"> 5</span>    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;viewport&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="p">&gt;</span>
<span class="linenos"> 6</span>    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Página de prueba<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="linenos"> 7</span><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="linenos"> 8</span><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="linenos"> 9</span>    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Bienvenido a mi página de prueba<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="linenos">10</span>    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>Aquí haremos pruebas varias<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
<span class="linenos">11</span>
<span class="linenos">12</span>    <span class="p">&lt;</span><span class="nt">nav</span><span class="p">&gt;</span>
<span class="linenos">13</span>        <span class="cm">&lt;!-- el template tag url lo usamos dentro del atribut href de un hipervínculo: --&gt;</span>
<span class="linenos">14</span>        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{% url &#39;home&#39; %}&quot;</span><span class="p">&gt;</span>Índice<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span> <span class="cm">&lt;!-- lleva entre comillas simples el nombre de la ruta que vamos a vincular --&gt;</span>
<span class="linenos">15</span>        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">&gt;</span>Sobre mí<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<span class="linenos">16</span>        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">&gt;</span>Contacto<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<span class="linenos">17</span>    <span class="p">&lt;/</span><span class="nt">nav</span><span class="p">&gt;</span>
<span class="linenos">18</span>
<span class="linenos">19</span>    {% block cuerpo %}{% endblock %}
<span class="linenos">20</span>
<span class="linenos">21</span>    <span class="p">&lt;</span><span class="nt">footer</span><span class="p">&gt;</span>Piptocode, hecho con cariño y para amantes de la programación<span class="p">&lt;/</span><span class="nt">footer</span><span class="p">&gt;</span>
<span class="linenos">22</span><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="linenos">23</span><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</div>
<div class="admonition attention">
<p class="admonition-title">Atención</p>
<p>Si añadimos un name que no existe en el archivo de rutas Django lanzará una pantalla de error en lugar de la plantilla.</p>
</div>
</section>
<section id="template-tag-static">
<h4><a class="toc-backref" href="#id34">Template tag static</a><a class="headerlink" href="#template-tag-static" title="Enlazar permanentemente con este título">#</a></h4>
<p>Con este template tag vamos a cargar archivos estáticos de nuestra web, entre ellos están las imágenes, videos, hojas de estilo y javascript.</p>
<ul class="simple">
<li><p>Siguiendo una práctica convencional creamos una carpeta llamada <strong>static</strong> dentro del directorio de la app y dentro de static una carpeta con el nombre de la app: <code class="docutils literal notranslate"><span class="pre">nombre_de_tu_app/static/nombre_de_tu_app</span></code>.</p></li>
<li><p>Dentro de la última carpeta podemos ir añadiendo carpetas básica como css, js e img para ir añadiendo los archivos correspondientes.</p></li>
<li><p>Ahora podemos utilizar archivos estáticos dentro de dichas rutas:</p></li>
</ul>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cm">&lt;!-- cargamos el template tag static --&gt;</span>
<span class="linenos"> 2</span>{% load static %}
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="linenos"> 5</span><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;es&quot;</span><span class="p">&gt;</span>
<span class="linenos"> 6</span><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="linenos"> 7</span>    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;UTF-8&quot;</span><span class="p">&gt;</span>
<span class="linenos"> 8</span>    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;viewport&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="p">&gt;</span>
<span class="linenos"> 9</span>    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Página de prueba<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="linenos">10</span>    <span class="cm">&lt;!-- ahora si queremos cargar un archivo estatico como una hoja de estilo lo hacemos así: --&gt;</span>
<span class="linenos">11</span>    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{% static &#39;nombre_de_tu_app/css/estilos.css&#39; %}&quot;</span><span class="p">&gt;</span>
<span class="linenos">12</span><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="linenos">13</span><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="linenos">14</span>    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Bienvenido a mi página de prueba<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="linenos">15</span>    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>Aquí haremos pruebas varias<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
<span class="linenos">16</span>
<span class="linenos">17</span>    <span class="p">&lt;</span><span class="nt">nav</span><span class="p">&gt;</span>
<span class="linenos">18</span>        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{% url &#39;home&#39; %}&quot;</span><span class="p">&gt;</span>Índice<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<span class="linenos">19</span>        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">&gt;</span>Sobre mí<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<span class="linenos">20</span>        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">&gt;</span>Contacto<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<span class="linenos">21</span>    <span class="p">&lt;/</span><span class="nt">nav</span><span class="p">&gt;</span>
<span class="linenos">22</span>
<span class="linenos">23</span>    {% block cuerpo %}{% endblock %}
<span class="linenos">24</span>
<span class="linenos">25</span>    <span class="p">&lt;</span><span class="nt">footer</span><span class="p">&gt;</span>Piptocode, hecho con cariño y para amantes de la programación<span class="p">&lt;/</span><span class="nt">footer</span><span class="p">&gt;</span>
<span class="linenos">26</span><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="linenos">27</span><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</div>
</section>
<section id="template-tag-de-datos">
<h4><a class="toc-backref" href="#id35">Template tag de datos</a><a class="headerlink" href="#template-tag-de-datos" title="Enlazar permanentemente con este título">#</a></h4>
<p>Los template tags de datos muestran información que enviamos desde la vista al template.</p>
<ul class="simple">
<li><p>Si nos vamos a views.py para añadir un dato:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>
<span class="linenos">2</span>
<span class="linenos">3</span><span class="k">def</span> <span class="nf">home</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<span class="linenos">4</span>    <span class="c1"># creamos una variable:</span>
<span class="linenos">5</span>    <span class="n">nombre</span> <span class="o">=</span> <span class="s2">&quot;Guillermo Granados Gómez&quot;</span>
<span class="linenos">6</span>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;nombre_de_tu_app/home.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;nombre&#39;</span><span class="p">:</span><span class="n">nombre</span><span class="p">})</span> <span class="c1"># devolvemos la información en un diccionario</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Ahora que tenemos un dato, podemos mostrarlo en cualquier template de nuestra app:</p></li>
</ul>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="linenos"> 2</span><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;es&quot;</span><span class="p">&gt;</span>
<span class="linenos"> 3</span><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="linenos"> 4</span>    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;UTF-8&quot;</span><span class="p">&gt;</span>
<span class="linenos"> 5</span>    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;viewport&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="p">&gt;</span>
<span class="linenos"> 6</span>    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Página de prueba<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="linenos"> 7</span><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="linenos"> 8</span><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>     <span class="cm">&lt;!-- Ahora podemos mostrar el dato usando su clave --&gt;</span>
<span class="linenos"> 9</span>    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Bienvenido a la web de {{ nombre }}<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="linenos">10</span>    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>Aquí haremos pruebas varias<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
<span class="linenos">11</span>
<span class="linenos">12</span>    <span class="p">&lt;</span><span class="nt">nav</span><span class="p">&gt;</span>
<span class="linenos">13</span>        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{% url &#39;home&#39; %}&quot;</span><span class="p">&gt;</span>Índice<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<span class="linenos">14</span>        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">&gt;</span>Sobre mí<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<span class="linenos">15</span>        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">&gt;</span>Contacto<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<span class="linenos">16</span>    <span class="p">&lt;/</span><span class="nt">nav</span><span class="p">&gt;</span>
<span class="linenos">17</span>
<span class="linenos">18</span>    {% block cuerpo %}{% endblock %}
<span class="linenos">19</span>
<span class="linenos">20</span>    <span class="p">&lt;</span><span class="nt">footer</span><span class="p">&gt;</span>Piptocode, hecho con cariño y para amantes de la programación<span class="p">&lt;/</span><span class="nt">footer</span><span class="p">&gt;</span>
<span class="linenos">21</span><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="linenos">22</span><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</div>
</section>
<section id="template-tag-for">
<h4><a class="toc-backref" href="#id36">Template tag for</a><a class="headerlink" href="#template-tag-for" title="Enlazar permanentemente con este título">#</a></h4>
<p>En los templates de Django para hacer un bucle for lo hacemos del siguiente modo:</p>
<ul class="simple">
<li><p>Para empezar necesitamos un diccionario al que acceder desde views.py:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="k">def</span> <span class="nf">home</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<span class="linenos"> 4</span>    <span class="c1"># creamos un diccionario:</span>
<span class="linenos"> 5</span>    <span class="n">personas</span> <span class="o">=</span> <span class="p">[</span>
<span class="linenos"> 6</span>        <span class="p">{</span><span class="s1">&#39;nombre&#39;</span><span class="p">:</span> <span class="s1">&#39;Pepe&#39;</span><span class="p">,</span> <span class="s1">&#39;edad&#39;</span><span class="p">:</span> <span class="mi">26</span><span class="p">},</span>
<span class="linenos"> 7</span>        <span class="p">{</span><span class="s1">&#39;nombre&#39;</span><span class="p">:</span> <span class="s1">&#39;Antonio&#39;</span><span class="p">,</span> <span class="s1">&#39;edad&#39;</span><span class="p">:</span> <span class="mi">38</span><span class="p">},</span>
<span class="linenos"> 8</span>        <span class="p">{</span><span class="s1">&#39;nombre&#39;</span><span class="p">:</span> <span class="s1">&#39;María&#39;</span><span class="p">,</span> <span class="s1">&#39;edad&#39;</span><span class="p">:</span> <span class="mi">37</span><span class="p">}</span>
<span class="linenos"> 9</span>    <span class="p">]</span>
<span class="linenos">10</span>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;pruebauno/home.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;personas&#39;</span><span class="p">:</span><span class="n">personas</span><span class="p">})</span> <span class="c1"># devolvemos la información en un diccionario</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Y ahora podemos recorrer el diccionario en nuestro template con el template tag for:</p></li>
</ul>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>Listado de Clientes<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="linenos">2</span><span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
<span class="linenos">3</span>    {% for persona in personas %} <span class="cm">&lt;!-- Abrimos el bucle for en el template --&gt;</span>
<span class="linenos">4</span>        <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>Nombre: {{ persona.nombre }}, Edad: {{ persona.edad }}<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span> <span class="cm">&lt;!-- Creamos el elemento que va a iterar en la lista imprimiendo los valores --&gt;</span>
<span class="linenos">5</span>    {% endfor %} <span class="cm">&lt;!-- Y lleva una llave de cierre --&gt;</span>
<span class="linenos">6</span><span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
</pre></div>
</div>
</section>
<section id="template-tag-if">
<h4><a class="toc-backref" href="#id37">Template tag if</a><a class="headerlink" href="#template-tag-if" title="Enlazar permanentemente con este título">#</a></h4>
<p>Con el template tag if podemos establecer condiciones dentro de los templates, retomando el ejemplo de for vamos a pintar de verde uno de los registros:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>&lt;h3&gt;Listado de Clientes&lt;/h3&gt;
<span class="linenos">2</span>&lt;ul&gt;
<span class="linenos">3</span>    {% for persona in personas %}
<span class="linenos">4</span>        &lt;!-- Si en nombre se encuentra Antonio lo pintaremos de verde: --&gt;
<span class="linenos">5</span>        &lt;li {% if &#39;Antonio&#39; in persona.nombre  %} style=&quot;color: green&quot; {% endif %}&gt;
<span class="linenos">6</span>            Nombre: {{ persona.nombre }}, Edad: {{ persona.edad }}
<span class="linenos">7</span>        &lt;/li&gt;
<span class="linenos">8</span>    {% endfor %}
<span class="linenos">9</span>&lt;/ul&gt;
</pre></div>
</div>
</section>
</section>
<section id="crear-template-tags-customizados">
<h3><a class="toc-backref" href="#id38">Crear template tags customizados</a><a class="headerlink" href="#crear-template-tags-customizados" title="Enlazar permanentemente con este título">#</a></h3>
<p>Son muy útiles para cargar etiquetas con contenido específico que se pueda usar en plantillas.</p>
<p>Como preparar el archivo de templatetags:
1. Dentro de una app como <strong>core</strong> crear carpeta llamada <strong>templatetags</strong>.
2. Dentro de <strong>templatetags</strong> se crea un archivo con una colección de tags <strong>components.py</strong>:</p>
<section id="simple-tag">
<h4><a class="toc-backref" href="#id39">Simple tag</a><a class="headerlink" href="#simple-tag" title="Enlazar permanentemente con este título">#</a></h4>
<p>Devuelve información pura como números, cadenas, listados, objetos, diccionarios.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># se importa la librería template:</span>
<span class="linenos"> 2</span><span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">template</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="c1"># se registra la librería:</span>
<span class="linenos"> 5</span><span class="n">register</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">Library</span><span class="p">()</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="c1"># y se van creando cada una de las tags:</span>
<span class="linenos"> 8</span><span class="nd">@register</span><span class="o">.</span><span class="n">simple_tag</span>
<span class="linenos"> 9</span><span class="k">def</span> <span class="nf">get_title</span><span class="p">():</span>
<span class="linenos">10</span>    <span class="k">return</span> <span class="s1">&#39;bienvenidos a mi página&#39;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Cogemos un template y lo aplicamos:</p></li>
</ul>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cm">&lt;!-- Se carga el módulo con los template tags: --&gt;</span>
<span class="linenos"> 2</span>{% load components %}
<span class="linenos"> 3</span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="linenos"> 4</span><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;en&quot;</span><span class="p">&gt;</span>
<span class="linenos"> 5</span><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="linenos"> 6</span>    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;UTF-8&quot;</span><span class="p">&gt;</span>
<span class="linenos"> 7</span>    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&quot;X-UA-Compatible&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;IE=edge&quot;</span><span class="p">&gt;</span>
<span class="linenos"> 8</span>    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;viewport&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="p">&gt;</span>
<span class="linenos"> 9</span>    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Document<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="linenos">10</span><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="linenos">11</span><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="linenos">12</span>    <span class="cm">&lt;!-- hay que crear una variable a partir del simple_tag: --&gt;</span>
<span class="linenos">13</span>    {% get_title as title %}
<span class="linenos">14</span>    <span class="cm">&lt;!-- Utilizar la variable: --&gt;</span>
<span class="linenos">15</span>    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>{{ title }} <span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="linenos">16</span>    <span class="p">&lt;</span><span class="nt">form</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;POST&quot;</span><span class="p">&gt;</span>
<span class="linenos">17</span>        {{ form.as_p }}
<span class="linenos">18</span>        {% csrf_token %}
<span class="linenos">19</span>        <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span><span class="p">&gt;</span>Iniciar sesión<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="linenos">20</span>    <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
<span class="linenos">21</span>    <span class="p">&lt;</span><span class="nt">hr</span> <span class="p">/&gt;</span>
<span class="linenos">22</span>    <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{% url &#39;register&#39; %}&quot;</span><span class="p">&gt;</span>Crear usuario<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<span class="linenos">23</span><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="linenos">24</span><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</div>
</section>
<section id="filter-tags">
<h4><a class="toc-backref" href="#id40">Filter tags</a><a class="headerlink" href="#filter-tags" title="Enlazar permanentemente con este título">#</a></h4>
<p>Los filter tags se utilizan para filtrar datos en otros tags, y pueden ser simples o compuestos:</p>
<ul class="simple">
<li><p>Se reutiliza el archivo <strong>components.py</strong> (aunque se puede crear uno nuevo):</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># se puede registrar un filtro sencillo:</span>
<span class="linenos"> 2</span><span class="nd">@register</span><span class="o">.</span><span class="n">filter</span>
<span class="linenos"> 3</span><span class="k">def</span> <span class="nf">upper</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
<span class="linenos"> 4</span>    <span class="k">return</span> <span class="n">value</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="c1"># o un filtro con hasta dos parámetros:</span>
<span class="linenos"> 7</span><span class="nd">@register</span><span class="o">.</span><span class="n">filter</span>
<span class="linenos"> 8</span><span class="k">def</span> <span class="nf">change_language</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span>    <span class="k">if</span> <span class="n">arg</span> <span class="o">==</span> <span class="s1">&#39;english&#39;</span><span class="p">:</span>
<span class="linenos">11</span>        <span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;Welcome to my site&#39;</span>
<span class="linenos">12</span>    <span class="k">if</span> <span class="n">arg</span> <span class="o">==</span> <span class="s1">&#39;français&#39;</span><span class="p">:</span>
<span class="linenos">13</span>        <span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;bienvenu à mon site&#39;</span>
<span class="linenos">14</span>
<span class="linenos">15</span>    <span class="k">return</span> <span class="n">value</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Estos filtros son utilizados en los templates así:</p></li>
</ul>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span>{% load components %}
<span class="linenos"> 2</span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="linenos"> 3</span><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;en&quot;</span><span class="p">&gt;</span>
<span class="linenos"> 4</span><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="linenos"> 5</span>    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;UTF-8&quot;</span><span class="p">&gt;</span>
<span class="linenos"> 6</span>    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&quot;X-UA-Compatible&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;IE=edge&quot;</span><span class="p">&gt;</span>
<span class="linenos"> 7</span>    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;viewport&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="p">&gt;</span>
<span class="linenos"> 8</span>    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Document<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="linenos"> 9</span><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="linenos">10</span><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="linenos">11</span>    {% get_title as title %}
<span class="linenos">12</span>    <span class="cm">&lt;!-- Utilizar un filtro simple: --&gt;</span>
<span class="linenos">13</span>    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>{{ title|upper }} <span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="linenos">14</span>    <span class="cm">&lt;!-- Utilizar filtros compuestos: --&gt;</span>
<span class="linenos">15</span>    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>{{ title|change_language:&#39;english&#39; }} <span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
<span class="linenos">16</span>    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>{{ title|change_language:&#39;français&#39; }} <span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
<span class="linenos">17</span>    <span class="p">&lt;</span><span class="nt">form</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;POST&quot;</span><span class="p">&gt;</span>
<span class="linenos">18</span>        {{ form.as_p }}
<span class="linenos">19</span>        {% csrf_token %}
<span class="linenos">20</span>        <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span><span class="p">&gt;</span>Iniciar sesión<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="linenos">21</span>    <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
<span class="linenos">22</span>    <span class="p">&lt;</span><span class="nt">hr</span> <span class="p">/&gt;</span>
<span class="linenos">23</span>    <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{% url &#39;register&#39; %}&quot;</span><span class="p">&gt;</span>Crear usuario<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<span class="linenos">24</span><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="linenos">25</span><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="modelos">
<h2><a class="toc-backref" href="#id41">Modelos</a><a class="headerlink" href="#modelos" title="Enlazar permanentemente con este título">#</a></h2>
<p>Los modelos en Django sirven para crear estructuras de bases de datos con las que podremos interactuar gracias a sus QuerySets.</p>
<p>En cada app que creamos tenemos un archivo models.py, vamos a editar uno para ver que campos tiene:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># Los modelos se crean usando una clase que hereda de la superclase Model:</span>
<span class="linenos"> 2</span><span class="k">class</span> <span class="nc">Prueba</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<span class="linenos"> 3</span>    <span class="n">autor</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="n">verbose_name</span> <span class="o">=</span> <span class="s2">&quot;Autor&quot;</span><span class="p">,</span> <span class="n">on_delete</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">)</span> <span class="c1"># El primero es una clave foranea para vincular otras tablas como la de usuarios que viene por defecto</span>
<span class="linenos"> 4</span>    <span class="n">titulo</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;Título&quot;</span><span class="p">)</span> <span class="c1"># CharField es un campo de tipo texto, el primer parámetro que le pasamos define el tamaño máximo y es obligatorio, el segundo es opcional y sirve para todos los campos (verbose_name define como se mostrará la label del panel de administración)</span>
<span class="linenos"> 5</span>    <span class="n">descripcion</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;Descripción&quot;</span><span class="p">)</span> <span class="c1"># Con TextField tenemos una caja de texto sin límite de rango.</span>
<span class="linenos"> 6</span>    <span class="n">link</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">URLField</span><span class="p">(</span><span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;Enlace&quot;</span><span class="p">)</span> <span class="c1"># URLField nos permite agregar una url válida.</span>
<span class="linenos"> 7</span>    <span class="n">fecha_creacion</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">auto_now_add</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="c1"># crea un campo de fecha y hora, podemos pasarle la fecha de una publicación de forma automática con auto_now_add.</span>
<span class="linenos"> 8</span>    <span class="n">fecha_edicion</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">(</span><span class="n">auto_now</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="c1"># aquí tenemos otra variante, en primer lugar DateField guarda solo la fecha y opcionalmente podemos decir que lo haga cuando editamos la entrada con auto_now.</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span>
<span class="linenos">11</span>    <span class="c1"># opcionalmente podemos usar la clase Meta para editar valores que nos servirán para mostrar los datos en el panel de administración:</span>
<span class="linenos">12</span>    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
<span class="linenos">13</span>        <span class="n">verbose_name</span> <span class="o">=</span> <span class="s2">&quot;prueba&quot;</span> <span class="c1"># Nombre de la tabla en el panel.</span>
<span class="linenos">14</span>        <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="s2">&quot;pruebas&quot;</span> <span class="c1"># nombre en plural.</span>
<span class="linenos">15</span>        <span class="n">ordering</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;-fecha_creacion&quot;</span><span class="p">]</span> <span class="c1"># Orden prioritario, en este caso por fecha descenciente.</span>
<span class="linenos">16</span>
<span class="linenos">17</span>    <span class="c1"># Con esta función podemos retornar en el panel de administración un valor de referencia</span>
<span class="linenos">18</span>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos">19</span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">titulo</span>
</pre></div>
</div>
<div class="admonition attention">
<p class="admonition-title">Atención</p>
<p>Tienes que tener registrada tu app en el apartado INSTALLED_APPS o sino dará error a la hora de migrar la base de datos.</p>
</div>
<div class="admonition hint">
<p class="admonition-title">Consejo</p>
<p>Los parámetros comunes para prácticamente todos los campos son verbose_name (nombre que muestra), blank (True o False para permitir el campo vacío), null (True o False para permitir campo nulo)</p>
</div>
<section id="cargar-imagenes-en-modelos-con-pillow">
<h3><a class="toc-backref" href="#id42">Cargar imágenes en modelos con Pillow</a><a class="headerlink" href="#cargar-imagenes-en-modelos-con-pillow" title="Enlazar permanentemente con este título">#</a></h3>
<p>Pillow es una librería de Python que se utiliza para el tratamiento de imágenes. En Django la podemos utilizar para gestionar la carga de estas.</p>
<ul class="simple">
<li><p>Lo primero que tenemos que hacer es instalar Pillow en nuestro entorno: <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">Pillow</span></code></p></li>
<li><p>Ahora vamos a editar nuestra clase de models.py:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">class</span> <span class="nc">Prueba</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<span class="linenos"> 2</span>    <span class="n">autor</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="n">verbose_name</span> <span class="o">=</span> <span class="s2">&quot;Autor&quot;</span><span class="p">,</span> <span class="n">on_delete</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">)</span>
<span class="linenos"> 3</span>    <span class="n">titulo</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;Título&quot;</span><span class="p">)</span>
<span class="linenos"> 4</span>    <span class="n">descripcion</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;Descripción&quot;</span><span class="p">)</span>
<span class="linenos"> 5</span>    <span class="n">fecha_creacion</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">auto_now_add</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 6</span>    <span class="n">fecha_edicion</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">(</span><span class="n">auto_now</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 7</span>    <span class="c1"># con ImageField podemos subir una imagen a un directorio que elijamos:</span>
<span class="linenos"> 8</span>    <span class="n">imagen</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ImageField</span><span class="p">(</span><span class="n">upload_to</span><span class="o">=</span><span class="s2">&quot;imagenes/&quot;</span><span class="p">)</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span>    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
<span class="linenos">11</span>        <span class="n">verbose_name</span> <span class="o">=</span> <span class="s2">&quot;prueba&quot;</span>
<span class="linenos">12</span>        <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="s2">&quot;pruebas&quot;</span>
<span class="linenos">13</span>        <span class="n">ordering</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;-fecha_creacion&quot;</span><span class="p">]</span>
<span class="linenos">14</span>
<span class="linenos">15</span>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos">16</span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">titulo</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Para poder subir las imágenes tenemos que añadir en settings.py la siguiente línea:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">MEDIA_URL</span> <span class="o">=</span> <span class="s1">&#39;/media/&#39;</span>
<span class="linenos">2</span><span class="n">MEDIA_ROOT</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s1">&#39;media&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Finalmente nos vamos al archivo de rutas principal (el que se encuentra dentro de la carpeta con el nombre de tu proyecto) y añadimos la siguiente configuración para poder visualizar las imágenes desde el panel:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="linenos"> 2</span><span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">path</span>
<span class="linenos"> 3</span><span class="kn">from</span> <span class="nn">nombre_de_tu_app</span> <span class="kn">import</span> <span class="n">views</span>
<span class="linenos"> 4</span><span class="c1"># Importamos la librería settings:</span>
<span class="linenos"> 5</span><span class="kn">from</span> <span class="nn">django.conf</span> <span class="kn">import</span> <span class="n">settings</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
<span class="linenos"> 8</span>    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;admin/&#39;</span><span class="p">,</span> <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">),</span>
<span class="linenos"> 9</span>    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">home</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;home&#39;</span><span class="p">),</span>
<span class="linenos">10</span><span class="p">]</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="c1"># Cargamos la ruta siempre que este en modo debug:</span>
<span class="linenos">13</span><span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">:</span>
<span class="linenos">14</span>    <span class="kn">from</span> <span class="nn">django.conf.urls.static</span> <span class="kn">import</span> <span class="n">static</span>
<span class="linenos">15</span>    <span class="n">urlpatterns</span> <span class="o">+=</span> <span class="n">static</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">MEDIA_URL</span><span class="p">,</span> <span class="n">document_root</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">MEDIA_ROOT</span><span class="p">)</span>
</pre></div>
</div>
<p>De este modo y mientras no estemos en producción podremos visualizar las imágenes desde el panel de administrador para probar que funciona correctamente.</p>
</section>
<section id="modelo-de-muchos-a-muchos">
<h3><a class="toc-backref" href="#id43">Modelo de muchos a muchos</a><a class="headerlink" href="#modelo-de-muchos-a-muchos" title="Enlazar permanentemente con este título">#</a></h3>
<p>En base de datos un modelo de muchos a muchos nos sirve para establecer una relación entre múltiples componentes de ambas tablas, como por ejemplo crear una lista de categorías:
* Sería algo así nuestro modelo:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># primero creamos un modelo para guardar las categorías:</span>
<span class="linenos"> 2</span><span class="k">class</span> <span class="nc">Category</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<span class="linenos"> 3</span>    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;Nombre&quot;</span><span class="p">)</span>
<span class="linenos"> 4</span>    <span class="n">created</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">auto_now_add</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;Fecha de creación&quot;</span><span class="p">)</span>
<span class="linenos"> 5</span>    <span class="n">updated</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">auto_now</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;Fecha de edición&quot;</span><span class="p">)</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
<span class="linenos"> 8</span>    <span class="n">verbose_name</span> <span class="o">=</span> <span class="s2">&quot;categoria&quot;</span>
<span class="linenos"> 9</span>    <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="s2">&quot;categorias&quot;</span>
<span class="linenos">10</span>    <span class="n">ordering</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;-created&quot;</span><span class="p">]</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos">13</span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="k">class</span> <span class="nc">Prueba</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<span class="linenos">16</span>    <span class="n">autor</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="n">verbose_name</span> <span class="o">=</span> <span class="s2">&quot;Autor&quot;</span><span class="p">,</span> <span class="n">on_delete</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">)</span>
<span class="linenos">17</span>    <span class="n">titulo</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;Título&quot;</span><span class="p">)</span>
<span class="linenos">18</span>    <span class="n">descripcion</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;Descripción&quot;</span><span class="p">)</span>
<span class="linenos">19</span>    <span class="n">fecha_creacion</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">auto_now_add</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="linenos">20</span>    <span class="n">fecha_edicion</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">(</span><span class="n">auto_now</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="linenos">21</span>    <span class="n">imagen</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ImageField</span><span class="p">(</span><span class="n">upload_to</span><span class="o">=</span><span class="s2">&quot;imagenes/&quot;</span><span class="p">)</span>
<span class="linenos">22</span>    <span class="c1"># Ahora vamos a recuperar todas las categorías en la tabla que queremos usar:</span>
<span class="linenos">23</span>    <span class="n">categorias</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ManyToManyField</span><span class="p">(</span><span class="n">Category</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;Categorías&quot;</span><span class="p">)</span>
<span class="linenos">24</span>
<span class="linenos">25</span>    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
<span class="linenos">26</span>        <span class="n">verbose_name</span> <span class="o">=</span> <span class="s2">&quot;prueba&quot;</span>
<span class="linenos">27</span>        <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="s2">&quot;pruebas&quot;</span>
<span class="linenos">28</span>        <span class="n">ordering</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;-fecha_creacion&quot;</span><span class="p">]</span>
<span class="linenos">29</span>
<span class="linenos">30</span>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos">31</span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">titulo</span>
</pre></div>
</div>
<p>Ahora podemos generar categorías incluso desde la tabla de pruebas cuando ingresamos o editamos un registro.</p>
</section>
<section id="generar-modelo-y-migrar-la-base-de-datos">
<h3><a class="toc-backref" href="#id44">Generar modelo y migrar la base de datos</a><a class="headerlink" href="#generar-modelo-y-migrar-la-base-de-datos" title="Enlazar permanentemente con este título">#</a></h3>
<p>Cuando creamos un modelo nuevo lo primero que tenemos que hacer es maquetar la estructura que vamos a migrar cada vez que generemos la base de datos:</p>
<ul class="simple">
<li><p>Para crear el modelo de las tablas de una app ejecutamos <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">makemigrations</span></code>.</p></li>
<li><p>Si todo va bien, migramos la base de datos con <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">migrate</span></code></p></li>
<li><p>Para comprobar el estado de las migraciones se ejecuta: <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">showmigrations</span></code></p></li>
</ul>
</section>
</section>
<section id="orm-de-django-y-sus-querysets">
<h2><a class="toc-backref" href="#id45">ORM de Django y sus QuerySets</a><a class="headerlink" href="#orm-de-django-y-sus-querysets" title="Enlazar permanentemente con este título">#</a></h2>
<p>Los QuerySets son listas de objetos que se recuperan de la base de datos de forma similar a una consulta SQL. Existen una serie de
sentencias trabajar con estos datos.</p>
<ul class="simple">
<li><p>Lo primero que vamos a hacer es ejecutar <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">shell</span></code>, esto abrirá la consola del ORM.</p></li>
<li><p>Una vez arrancada lo primero que tenemos que hacer para las pruebas es importar un modelo <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">nombre_de_tu_app</span> <span class="pre">import</span> <span class="pre">Prueba</span></code></p></li>
</ul>
<p>Ahora vamos a conocer los distintos comandos para realizar QuerySets:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Prueba.objects.all()</span></code>: devuelve todos los registros de la tabla Prueba</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Prueba.objects.create(titulo=&quot;Ejemplo&quot;,</span> <span class="pre">descripcion=&quot;esto</span> <span class="pre">es</span> <span class="pre">una</span> <span class="pre">entrada&quot;)</span></code>: Genera un nuevo registro en la tabla Prueba, ten en cuenta que esten todos los campos o sino que puedan estar en blanco (blank=True)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Prueba.objects.filter(titulo__contains</span> <span class="pre">=</span> <span class="pre">'Ejemplo')</span></code>: Permite filtrar las tablas para devolver solo aquellos que contienen la palabra clave, si quitamos __contains solo obtendrá los que tengan exactamente y únicamente esa palabra.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Prueba.objects.filter(titulo__contains</span> <span class="pre">=</span> <span class="pre">'Ejemplo').first()</span></code>: Añadiendo el metodo first trae solo el primer registro.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Prueba.objects.count()</span></code>: Devuelve el número total de registros que hay en la tabla.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Prueba.objects.order_by('fecha_creacion')</span></code>: Permite ordenar los registros de la tabla nuevamente cuando se cargan en la vista.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Prueba.objects.filter(pk=1).update(titulo=&quot;Novedad&quot;)</span></code>: Edita un registro ya existente.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Prueba.objects.delete(titulo=&quot;Ejemplo&quot;)</span></code>: Elimina un valor según el campo que hayamos elegido para buscarlo</p></li>
</ul>
<p>Para salir de la consola ORM escribimos <code class="docutils literal notranslate"><span class="pre">exit()</span></code> y pulsamos intro</p>
<div class="admonition hint">
<p class="admonition-title">Consejo</p>
<p>Podemos encadenar algunos querysets por ejemplo recuperar todos los datos y ordenarlos por fecha: <code class="docutils literal notranslate"><span class="pre">Prueba.objects.all().order_by('-fecha_creacion')</span></code></p>
</div>
<div class="admonition hint">
<p class="admonition-title">Consejo</p>
<p>Para filtrar por campos de una tabla relacionada se usa doble guión bajo en la clave foranea: <code class="docutils literal notranslate"><span class="pre">Videojuego.objects.filter(Consola__marca:'Sega')</span></code></p>
</div>
<section id="realizar-querysets-desde-vista-y-pasarlos-a-template">
<h3><a class="toc-backref" href="#id46">Realizar QuerySets desde vista y pasarlos a template</a><a class="headerlink" href="#realizar-querysets-desde-vista-y-pasarlos-a-template" title="Enlazar permanentemente con este título">#</a></h3>
<p>Es algo muy común, y es que cuando trabajamos con vistas FBV es el método estandar, para trabajar datos del modelo en la vista lo hacemos del siguiente modo, editamos views.py:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>
<span class="linenos">2</span><span class="c1"># Importamos el Modelo:</span>
<span class="linenos">3</span><span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">Prueba</span>
<span class="linenos">4</span>
<span class="linenos">5</span><span class="k">def</span> <span class="nf">home</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<span class="linenos">6</span>    <span class="c1"># creamos una variable:</span>
<span class="linenos">7</span>    <span class="n">cosas</span> <span class="o">=</span> <span class="n">Prueba</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="linenos">8</span>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;nombre_de_tu_app/home.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;cosas&#39;</span><span class="p">:</span><span class="n">cosas</span><span class="p">})</span> <span class="c1"># pasamos el queryset por una variable y este lo trata en el template como un diccionario.</span>
</pre></div>
</div>
</section>
</section>
<section id="formularios">
<h2><a class="toc-backref" href="#id47">Formularios</a><a class="headerlink" href="#formularios" title="Enlazar permanentemente con este título">#</a></h2>
<p>En Django podemos crear formularios individuales y reutilizables.</p>
<section id="crear-un-formulario-basico">
<h3><a class="toc-backref" href="#id48">Crear un formulario básico</a><a class="headerlink" href="#crear-un-formulario-basico" title="Enlazar permanentemente con este título">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># importamos la librería forms:</span>
<span class="linenos"> 2</span><span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">forms</span>
<span class="linenos"> 3</span><span class="c1"># Esto se importa opcionalmente si usamos fechas:</span>
<span class="linenos"> 4</span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="c1"># Creamos un formulario utilizando una clase que hereda de forms:</span>
<span class="linenos"> 7</span><span class="k">class</span> <span class="nc">ContactoForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">Form</span><span class="p">):</span>
<span class="linenos"> 8</span>    <span class="c1"># Cada campo recibe un tipo de dato con un label que es la etiqueta html y si es requerido:</span>
<span class="linenos"> 9</span>    <span class="n">nombre</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Nombre&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># CharField es para campo de texto</span>
<span class="linenos">10</span>    <span class="n">email</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">EmailField</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Correo&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># Email para correos</span>
<span class="linenos">11</span>    <span class="n">url</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">URLField</span><span class="p">(</span><span class="n">initial</span><span class="o">=</span><span class="s1">&#39;https://&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Web&quot;</span><span class="p">)</span> <span class="c1"># Este sirve para insertar una url y le podemos pasar un valor inicial</span>
<span class="linenos">12</span>    <span class="n">fecha_nacimiento</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">DateField</span><span class="p">(</span><span class="n">initial</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">)</span> <span class="c1"># este sirve para añadir una fecha y podemos pasarle la de hoy si importamos &#39;datetime&#39;</span>
<span class="linenos">13</span>    <span class="n">contenido</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;contenido&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">widget</span><span class="o">=</span><span class="n">forms</span><span class="o">.</span><span class="n">Textarea</span><span class="p">)</span> <span class="c1"># con widget le cambiamos el aspecto directamente para que sea un textarea</span>
</pre></div>
</div>
</section>
<section id="crear-un-formulario-usando-su-modelo">
<h3><a class="toc-backref" href="#id49">Crear un formulario usando su modelo</a><a class="headerlink" href="#crear-un-formulario-usando-su-modelo" title="Enlazar permanentemente con este título">#</a></h3>
<p>Este otro método es mas fácil de personalizar a mi parecer, y organiza mejor todo ademas de permitir elegir que campos se mostrarán del modelo de datos, así pues editamos forms.py:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">forms</span>
<span class="linenos"> 2</span><span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Prueba</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="k">class</span> <span class="nc">PruebaForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">ModelForm</span><span class="p">):</span>
<span class="linenos"> 5</span>    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
<span class="linenos"> 6</span>        <span class="c1"># elegimos el modelo de datos:</span>
<span class="linenos"> 7</span>        <span class="n">model</span> <span class="o">=</span> <span class="n">Prueba</span>
<span class="linenos"> 8</span>        <span class="c1"># Elegimos los campos que se mostrarán de dicho modelo:</span>
<span class="linenos"> 9</span>        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;titulo&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;contenido&#39;</span><span class="p">]</span>
<span class="linenos">10</span>        <span class="c1"># añadimos widgets para configurar el diseño de los campos del formulario:</span>
<span class="linenos">11</span>        <span class="n">widgets</span> <span class="o">=</span> <span class="p">{</span>                 <span class="c1"># podemos pasarle el atributo al input que queramos.</span>
<span class="linenos">12</span>            <span class="s1">&#39;titulo&#39;</span><span class="p">:</span> <span class="n">forms</span><span class="o">.</span><span class="n">TextInput</span><span class="p">(</span><span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span><span class="s1">&#39;formulario&#39;</span><span class="p">}),</span> <span class="c1"># Le asignamos la clase formulario</span>
<span class="linenos">13</span>            <span class="s1">&#39;contenido&#39;</span><span class="p">:</span> <span class="n">forms</span><span class="o">.</span><span class="n">Textarea</span><span class="p">(</span><span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span><span class="s1">&#39;formulario&#39;</span><span class="p">}),</span>
<span class="linenos">14</span>            <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="n">forms</span><span class="o">.</span><span class="n">EmailInput</span><span class="p">(</span><span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span><span class="s1">&#39;formulario&#39;</span><span class="p">})</span>
<span class="linenos">15</span>        <span class="p">}</span>
<span class="linenos">16</span>        <span class="c1"># Así se puede esconder opcionalmente las labels o cambiar su texto:</span>
<span class="linenos">17</span>        <span class="n">labels</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">18</span>            <span class="s1">&#39;title&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;order&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;content&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span>
<span class="linenos">19</span>        <span class="p">}</span>
<span class="linenos">20</span>
<span class="linenos">21</span><span class="n">De</span> <span class="n">este</span> <span class="n">modo</span> <span class="n">tenemos</span> <span class="n">otra</span> <span class="n">forma</span> <span class="n">de</span> <span class="n">sacar</span> <span class="n">los</span> <span class="n">formularios</span><span class="p">,</span> <span class="n">lo</span> <span class="n">demás</span> <span class="n">es</span> <span class="n">todo</span> <span class="n">igual</span><span class="o">.</span>
</pre></div>
</div>
</section>
<section id="crear-formulario-y-aceptar-parametros-para-su-configuracion">
<h3><a class="toc-backref" href="#id50">Crear formulario y aceptar parámetros para su configuración</a><a class="headerlink" href="#crear-formulario-y-aceptar-parametros-para-su-configuracion" title="Enlazar permanentemente con este título">#</a></h3>
<p>Este tercer método permite recibir parámetros al formulario de modo que podamos configurar ciertas características del mismo:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">class</span> <span class="nc">PublisherForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">ModelForm</span><span class="p">):</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="c1"># tenemos un campo con su uso más avanzado:</span>
<span class="linenos"> 4</span><span class="n">name</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span>
<span class="linenos"> 5</span>    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Nombre&#39;</span><span class="p">,</span>
<span class="linenos"> 6</span>    <span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span>
<span class="linenos"> 7</span>    <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="linenos"> 8</span>    <span class="n">widget</span><span class="o">=</span><span class="n">forms</span><span class="o">.</span><span class="n">TextInput</span><span class="p">(</span>
<span class="linenos"> 9</span>        <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;form-control&#39;</span><span class="p">}</span>
<span class="linenos">10</span>    <span class="p">)</span>
<span class="linenos">11</span><span class="p">)</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="c1"># En el meta rescatamos el Modelo y los campos:</span>
<span class="linenos">14</span><span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
<span class="linenos">15</span>    <span class="n">model</span> <span class="o">=</span> <span class="n">Publisher</span>
<span class="linenos">16</span>    <span class="n">fields</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="p">)</span>
<span class="linenos">17</span>
<span class="linenos">18</span><span class="c1"># Y ahora se define un init que recibirá los args y kwargs, estos segundos los usaremos para comprobar que se recibe:</span>
<span class="linenos">19</span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos">20</span>    <span class="c1"># se crean las variables con los argumentos posibles:</span>
<span class="linenos">21</span>    <span class="bp">self</span><span class="o">.</span><span class="n">required</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;required&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="linenos">22</span>    <span class="bp">self</span><span class="o">.</span><span class="n">readonly</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;readonly&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="linenos">23</span>    <span class="bp">self</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;disabled&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="linenos">24</span>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="linenos">25</span>
<span class="linenos">26</span>    <span class="c1"># se comprueba si se reciben y se genera el comportamiento de cada uno:</span>
<span class="linenos">27</span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">required</span><span class="p">:</span>
<span class="linenos">28</span>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">required</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
<span class="linenos">29</span>            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
<span class="linenos">30</span>                <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;required&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="linenos">31</span>        <span class="k">else</span><span class="p">:</span>
<span class="linenos">32</span>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">required</span><span class="p">:</span>
<span class="linenos">33</span>                <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;required&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="linenos">34</span>
<span class="linenos">35</span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">readonly</span><span class="p">:</span>
<span class="linenos">36</span>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">readonly</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
<span class="linenos">37</span>            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
<span class="linenos">38</span>                <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;readonly&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="linenos">39</span>        <span class="k">else</span><span class="p">:</span>
<span class="linenos">40</span>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">readonly</span><span class="p">:</span>
<span class="linenos">41</span>                <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;readonly&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="linenos">42</span>
<span class="linenos">43</span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">disabled</span><span class="p">:</span>
<span class="linenos">44</span>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">disabled</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
<span class="linenos">45</span>            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
<span class="linenos">46</span>                <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;disabled&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="linenos">47</span>        <span class="k">else</span><span class="p">:</span>
<span class="linenos">48</span>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">disabled</span><span class="p">:</span>
<span class="linenos">49</span>                <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;disabled&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="linenos">50</span>
<span class="linenos">51</span><span class="n">De</span> <span class="n">este</span> <span class="n">modo</span> <span class="n">se</span> <span class="n">tiene</span> <span class="n">un</span> <span class="n">control</span> <span class="n">universal</span> <span class="n">de</span> <span class="n">cada</span> <span class="n">campo</span><span class="o">.</span>
<span class="linenos">52</span>
<span class="linenos">53</span><span class="n">Si</span> <span class="n">queremos</span> <span class="n">establecer</span> <span class="n">un</span> <span class="n">campo</span> <span class="k">del</span> <span class="n">formulario</span> <span class="n">como</span> <span class="n">requerido</span><span class="p">:</span>
<span class="linenos">54</span><span class="o">*</span> <span class="n">form</span> <span class="o">=</span> <span class="n">PublisherForm</span><span class="p">(</span><span class="n">required</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Nombre&#39;</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="utilizar-un-formulario">
<h3><a class="toc-backref" href="#id51">Utilizar un formulario</a><a class="headerlink" href="#utilizar-un-formulario" title="Enlazar permanentemente con este título">#</a></h3>
<p>Si queremos usar un formulario lo importamos a la vista del siguiente modo.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>
<span class="linenos">2</span><span class="c1"># importamos el formulario:</span>
<span class="linenos">3</span><span class="kn">from</span> <span class="nn">.forms</span> <span class="kn">import</span> <span class="n">ContactoForm</span>
<span class="linenos">4</span>
<span class="linenos">5</span><span class="k">def</span> <span class="nf">contacto</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<span class="linenos">6</span>    <span class="n">form</span> <span class="o">=</span> <span class="n">ContactoForm</span><span class="p">()</span> <span class="c1"># cargamos el formulario en una variable</span>
<span class="linenos">7</span>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;nombre_de_tu_app/contacto.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;form&#39;</span><span class="p">:</span> <span class="n">form</span><span class="p">})</span> <span class="c1"># finalmente lo pasamos al template.</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Para cargar el formulario en la vista editamos el archivo html y lo añadimos:</p></li>
</ul>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">form</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;POST&quot;</span><span class="p">&gt;</span>
    {% csrf_token %} <span class="cm">&lt;!-- le pasamos el token --&gt;</span>
    {{formulario.as_p}} <span class="cm">&lt;!-- pasamos el formulario y lo formateamos en parrafos, si usamos as_table se formateará en tabla --&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span><span class="p">&gt;</span>Enviar mensaje<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span><span class="cm">&lt;!-- no olvides el botón submit --&gt;</span>
<span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
<span class="cm">&lt;!-- por último podemos depurar lo que envía el formulario con el siguiente tag: --&gt;</span>
{{request.POST}}
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Si queremos utilizar los campos sueltos para un mayor control del front se llaman como atributos de un objeto: <code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">formulario.nombre</span> <span class="pre">}}</span></code>
Esto carga el input, los label y cualquier otra propiedad relacionada con el campo.</p>
</div>
</section>
<section id="validar-un-formulario">
<h3><a class="toc-backref" href="#id52">Validar un formulario</a><a class="headerlink" href="#validar-un-formulario" title="Enlazar permanentemente con este título">#</a></h3>
<p>El formulario se valida una vez enviado a la vista antes de ser guardado o gestionado por la base de datos, veamoslo en views.py:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>
<span class="linenos"> 2</span><span class="kn">from</span> <span class="nn">.forms</span> <span class="kn">import</span> <span class="n">ContactoForm</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="k">def</span> <span class="nf">contacto</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<span class="linenos"> 5</span>    <span class="n">form</span> <span class="o">=</span> <span class="n">ContactoForm</span><span class="p">()</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span>    <span class="c1"># comprobamos que hemos recibido una petición post:</span>
<span class="linenos"> 8</span>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;POST&quot;</span><span class="p">:</span>
<span class="linenos"> 9</span>        <span class="c1"># le pasamos los datos a la plantilla del formulario:</span>
<span class="linenos">10</span>        <span class="n">form</span> <span class="o">=</span> <span class="n">ContactoForm</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">)</span>
<span class="linenos">11</span>
<span class="linenos">12</span>        <span class="c1"># validamos el formulario y si es correcto guardamos los datos en cada campo:</span>
<span class="linenos">13</span>        <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
<span class="linenos">14</span>            <span class="c1"># preparamos los datos para guardar:</span>
<span class="linenos">15</span>            <span class="n">registro</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">commit</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="linenos">16</span>            <span class="c1"># podemos editar algun dato por el camino:</span>
<span class="linenos">17</span>            <span class="n">registro</span><span class="o">.</span><span class="n">fecha_creacion</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">)</span>
<span class="linenos">18</span>            <span class="c1"># y guardamos el registro en el modelo:</span>
<span class="linenos">19</span>            <span class="n">registro</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="linenos">20</span>
<span class="linenos">21</span>            <span class="c1"># regresamos a la página de vuelta:</span>
<span class="linenos">22</span>            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;home&#39;</span><span class="p">))</span>
<span class="linenos">23</span>        <span class="k">else</span><span class="p">:</span>
<span class="linenos">24</span>            <span class="n">form</span> <span class="o">=</span> <span class="n">ContactoForm</span><span class="p">()</span>
<span class="linenos">25</span>
<span class="linenos">26</span>    <span class="c1"># si no se ha recibido ninguna petición post se carga como tal:</span>
<span class="linenos">27</span>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;nombre_de_tu_app/contacto.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;form&#39;</span><span class="p">:</span> <span class="n">form</span><span class="p">})</span>
</pre></div>
</div>
</section>
</section>
<section id="usuarios-en-django">
<h2><a class="toc-backref" href="#id53">Usuarios en Django</a><a class="headerlink" href="#usuarios-en-django" title="Enlazar permanentemente con este título">#</a></h2>
<p>Django cuenta con modelos integrados para gestionar usuarios y permisos</p>
<section id="users-o-usuarios">
<h3><a class="toc-backref" href="#id54">Users o usuarios</a><a class="headerlink" href="#users-o-usuarios" title="Enlazar permanentemente con este título">#</a></h3>
<section id="cargar-librerias">
<h4><a class="toc-backref" href="#id55">Cargar librerías</a><a class="headerlink" href="#cargar-librerias" title="Enlazar permanentemente con este título">#</a></h4>
<ul class="simple">
<li><p>Los metodos de usuarios se importan desde <code class="docutils literal notranslate"><span class="pre">django.contrib.auth</span></code> los metodos <code class="docutils literal notranslate"><span class="pre">authenticate</span></code>, <code class="docutils literal notranslate"><span class="pre">users</span></code>, <code class="docutils literal notranslate"><span class="pre">login</span></code>, <code class="docutils literal notranslate"><span class="pre">logout</span></code></p></li>
<li><p>El modelo de usuarios se importa desde <code class="docutils literal notranslate"><span class="pre">django.contrib.auth.models</span></code> en donde se encuentran <code class="docutils literal notranslate"><span class="pre">User</span></code> y <code class="docutils literal notranslate"><span class="pre">Group</span></code></p></li>
<li><p>Los formularios de usuarios se importan desde <code class="docutils literal notranslate"><span class="pre">django.contrib.auth.forms</span></code> en donde se encuentran <code class="docutils literal notranslate"><span class="pre">UserCreationForm</span></code> y <code class="docutils literal notranslate"><span class="pre">AuthenticationForm</span></code></p></li>
</ul>
<p>Se pueden llamar desde las vistas o los templates con <code class="docutils literal notranslate"><span class="pre">request.user</span></code> para hacer validaciones o simplemente mostrarlo.</p>
<p>También se pueden consultar en la bases de datos con el ORM:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">User.objects.create_user(username,</span> <span class="pre">password,</span> <span class="pre">email)</span></code>: Permite crear un nuevo usuario.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">User.objects.get(username).set_password('password')</span></code>: permite cambiar la contraseña.</p></li>
</ul>
</section>
<section id="sistema-de-autenticacion">
<h4><a class="toc-backref" href="#id56">Sistema de autenticación</a><a class="headerlink" href="#sistema-de-autenticacion" title="Enlazar permanentemente con este título">#</a></h4>
<ul class="simple">
<li><p>Preparando la ruta (urls.py):</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
<span class="linenos">2</span>    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;admin/&#39;</span><span class="p">,</span> <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">),</span>
<span class="linenos">3</span>    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">panel</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;panel&#39;</span><span class="p">),</span>
<span class="linenos">4</span>    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;register/&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">register</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;register&#39;</span><span class="p">),</span>
<span class="linenos">5</span>    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;login/&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;login&#39;</span><span class="p">),</span>
<span class="linenos">6</span>    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;logout/&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">close</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;logout&#39;</span><span class="p">),</span>
<span class="linenos">7</span><span class="p">]</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Preparando la vista (views.py):</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span><span class="p">,</span> <span class="n">redirect</span><span class="p">,</span> <span class="n">HttpResponse</span>
<span class="linenos"> 2</span><span class="c1"># importar los metodos del auth necesarios:</span>
<span class="linenos"> 3</span><span class="kn">from</span> <span class="nn">django.contrib.auth</span> <span class="kn">import</span> <span class="n">authenticate</span><span class="p">,</span> <span class="n">login</span><span class="p">,</span> <span class="n">logout</span>
<span class="linenos"> 4</span><span class="c1"># se importa el formulario de autenticación:</span>
<span class="linenos"> 5</span><span class="kn">from</span> <span class="nn">django.contrib.auth.forms</span> <span class="kn">import</span> <span class="n">AuthenticationForm</span><span class="p">,</span> <span class="n">UserCreationForm</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="k">def</span> <span class="nf">panel</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<span class="linenos"> 9</span>    <span class="c1"># preparamos la respuesta que por defecto redirige a login:</span>
<span class="linenos">10</span>    <span class="n">response</span> <span class="o">=</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;login&#39;</span><span class="p">)</span>
<span class="linenos">11</span>
<span class="linenos">12</span>    <span class="c1"># comprobamos que se ha iniciado sesión y cambiamos la respuesta de ser así:</span>
<span class="linenos">13</span>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">:</span>
<span class="linenos">14</span>        <span class="n">response</span> <span class="o">=</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;&lt;h1&gt;Hola &#39;</span> <span class="o">+</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">username</span> <span class="o">+</span> <span class="s1">&#39;!&lt;/h1&gt;&lt;a href=&quot;logout/&quot;&gt;Cerrar sesión&lt;/a&gt;&#39;</span><span class="p">)</span>
<span class="linenos">15</span>
<span class="linenos">16</span>    <span class="k">return</span> <span class="n">response</span>
<span class="linenos">17</span>
<span class="linenos">18</span>
<span class="linenos">19</span><span class="k">def</span> <span class="nf">register</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<span class="linenos">20</span>    <span class="c1"># cargamos el formulario de creación de usuarios:</span>
<span class="linenos">21</span>    <span class="n">form</span> <span class="o">=</span> <span class="n">UserCreationForm</span><span class="p">()</span>
<span class="linenos">22</span>    <span class="c1"># cargamos la respuesta:</span>
<span class="linenos">23</span>    <span class="n">response</span> <span class="o">=</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;core/register.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;form&#39;</span><span class="p">:</span> <span class="n">form</span><span class="p">})</span>
<span class="linenos">24</span>
<span class="linenos">25</span>    <span class="c1"># Se valida y se genera el nuevo usuario:</span>
<span class="linenos">26</span>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;POST&quot;</span><span class="p">:</span>
<span class="linenos">27</span>        <span class="n">form</span> <span class="o">=</span> <span class="n">UserCreationForm</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">)</span>
<span class="linenos">28</span>
<span class="linenos">29</span>        <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
<span class="linenos">30</span>            <span class="n">user</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="linenos">31</span>            <span class="c1"># Se puede aprovechar para hacer login automáticamente:</span>
<span class="linenos">32</span>            <span class="k">if</span> <span class="n">user</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">33</span>                <span class="n">login</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span>
<span class="linenos">34</span>                <span class="n">response</span> <span class="o">=</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;panel&#39;</span><span class="p">)</span>
<span class="linenos">35</span>
<span class="linenos">36</span>    <span class="k">return</span> <span class="n">response</span>
<span class="linenos">37</span>
<span class="linenos">38</span>
<span class="linenos">39</span><span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<span class="linenos">40</span>    <span class="c1"># se carga el formulario de autenticación:</span>
<span class="linenos">41</span>    <span class="n">form</span> <span class="o">=</span> <span class="n">AuthenticationForm</span><span class="p">()</span>
<span class="linenos">42</span>    <span class="c1"># preparamos la respuesta:</span>
<span class="linenos">43</span>    <span class="n">response</span> <span class="o">=</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s2">&quot;core/login.html&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;form&#39;</span><span class="p">:</span> <span class="n">form</span><span class="p">})</span>
<span class="linenos">44</span>
<span class="linenos">45</span>    <span class="c1"># si llega algo se intentará iniciar sesión:</span>
<span class="linenos">46</span>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
<span class="linenos">47</span>        <span class="n">form</span> <span class="o">=</span> <span class="n">AuthenticationForm</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">)</span>
<span class="linenos">48</span>
<span class="linenos">49</span>        <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
<span class="linenos">50</span>            <span class="n">username</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span>
<span class="linenos">51</span>            <span class="n">password</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]</span>
<span class="linenos">52</span>
<span class="linenos">53</span>            <span class="c1"># se verifica que el usuario existe o no:</span>
<span class="linenos">54</span>            <span class="n">user</span> <span class="o">=</span> <span class="n">authenticate</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">)</span>
<span class="linenos">55</span>
<span class="linenos">56</span>            <span class="c1"># si existe se inicia sesión:</span>
<span class="linenos">57</span>            <span class="k">if</span> <span class="n">user</span><span class="p">:</span>
<span class="linenos">58</span>                <span class="n">login</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span>
<span class="linenos">59</span>                <span class="n">response</span> <span class="o">=</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;panel&#39;</span><span class="p">)</span>
<span class="linenos">60</span>
<span class="linenos">61</span>    <span class="k">return</span> <span class="n">response</span>
<span class="linenos">62</span>
<span class="linenos">63</span>
<span class="linenos">64</span><span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<span class="linenos">65</span>    <span class="c1"># realizar logout:</span>
<span class="linenos">66</span>    <span class="n">logout</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<span class="linenos">67</span>    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;panel&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Preparando plantilla para login (login.html):</p></li>
</ul>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="linenos"> 2</span><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;en&quot;</span><span class="p">&gt;</span>
<span class="linenos"> 3</span><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="linenos"> 4</span><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="linenos"> 5</span><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="linenos"> 6</span>    <span class="p">&lt;</span><span class="nt">form</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;POST&quot;</span><span class="p">&gt;</span>
<span class="linenos"> 7</span>        {{ form.as_p }}
<span class="linenos"> 8</span>        {% csrf_token %}
<span class="linenos"> 9</span>        <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span><span class="p">&gt;</span>Iniciar sesión<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="linenos">10</span>    <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
<span class="linenos">11</span>    <span class="p">&lt;</span><span class="nt">hr</span> <span class="p">/&gt;</span>
<span class="linenos">12</span>    <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{% url &#39;register&#39; %}&quot;</span><span class="p">&gt;</span>Crear usuario<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<span class="linenos">13</span><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="linenos">14</span><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Preparamos plantilla para el registro (register.html):</p></li>
</ul>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="linenos"> 2</span><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;en&quot;</span><span class="p">&gt;</span>
<span class="linenos"> 3</span><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="linenos"> 4</span><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="linenos"> 5</span><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="linenos"> 6</span>    <span class="p">&lt;</span><span class="nt">form</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;POST&quot;</span><span class="p">&gt;</span>
<span class="linenos"> 7</span>        {{ form.as_p }}
<span class="linenos"> 8</span>        {% csrf_token %}
<span class="linenos"> 9</span>        <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span><span class="p">&gt;</span>Registrar usuario<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="linenos">10</span>    <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
<span class="linenos">11</span>    <span class="p">&lt;</span><span class="nt">hr</span> <span class="p">/&gt;</span>
<span class="linenos">12</span>    <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{% url &#39;login&#39; %}&quot;</span><span class="p">&gt;</span>Iniciar sesión<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<span class="linenos">13</span><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="linenos">14</span><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</div>
</section>
<section id="cambiar-usuario-por-email">
<h4><a class="toc-backref" href="#id57">Cambiar usuario por email</a><a class="headerlink" href="#cambiar-usuario-por-email" title="Enlazar permanentemente con este título">#</a></h4>
<p>Se puede reemplazar el campo para iniciar sesión por otro valor como un DNI o también el Email:</p>
<ul class="simple">
<li><p>Abstaer el formulario para usar email (forms.py):</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">forms</span>
<span class="linenos"> 2</span><span class="c1"># se importan los formularios de creación y autenticación para abstraer:</span>
<span class="linenos"> 3</span><span class="kn">from</span> <span class="nn">django.contrib.auth.forms</span> <span class="kn">import</span> <span class="n">UserCreationForm</span><span class="p">,</span> <span class="n">AuthenticationForm</span>
<span class="linenos"> 4</span><span class="c1"># se importa el modelo user:</span>
<span class="linenos"> 5</span><span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="kn">import</span> <span class="n">User</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="c1"># Extender un nuevo formulario a partir del original:</span>
<span class="linenos"> 8</span><span class="k">class</span> <span class="nc">CreationWithEmail</span><span class="p">(</span><span class="n">UserCreationForm</span><span class="p">):</span>
<span class="linenos"> 9</span>    <span class="c1"># se recupera el campo username y se cambia su formato:</span>
<span class="linenos">10</span>    <span class="n">username</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">EmailField</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Correo electrónico&#39;</span><span class="p">)</span>
<span class="linenos">11</span>
<span class="linenos">12</span>    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
<span class="linenos">13</span>        <span class="n">model</span> <span class="o">=</span> <span class="n">User</span>
<span class="linenos">14</span>        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;password1&#39;</span><span class="p">,</span> <span class="s1">&#39;password2&#39;</span><span class="p">]</span>
<span class="linenos">15</span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="c1"># hacemos lo mismo con authentication:</span>
<span class="linenos">18</span><span class="k">class</span> <span class="nc">AuthenticationEmail</span><span class="p">(</span><span class="n">AuthenticationForm</span><span class="p">):</span>
<span class="linenos">19</span>    <span class="n">username</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">EmailField</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Correo electrónico&#39;</span><span class="p">)</span>
<span class="linenos">20</span>
<span class="linenos">21</span>    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
<span class="linenos">22</span>        <span class="n">model</span> <span class="o">=</span> <span class="n">User</span>
<span class="linenos">23</span>        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;password1&#39;</span><span class="p">]</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Implementar formularios en las vistas de login y register (views.py):</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span><span class="p">,</span> <span class="n">redirect</span><span class="p">,</span> <span class="n">HttpResponse</span>
<span class="linenos"> 2</span><span class="kn">from</span> <span class="nn">django.contrib.auth</span> <span class="kn">import</span> <span class="n">authenticate</span><span class="p">,</span> <span class="n">login</span><span class="p">,</span> <span class="n">logout</span>
<span class="linenos"> 3</span><span class="c1"># se reemplazan los forms de auth por los recien creados:</span>
<span class="linenos"> 4</span><span class="kn">from</span> <span class="nn">.forms</span> <span class="kn">import</span> <span class="n">CreationWithEmail</span><span class="p">,</span> <span class="n">AuthenticationEmail</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="k">def</span> <span class="nf">register</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<span class="linenos"> 8</span>    <span class="c1"># Reemplazamos el formulario:</span>
<span class="linenos"> 9</span>    <span class="n">form</span> <span class="o">=</span> <span class="n">CreationWithEmail</span><span class="p">()</span>
<span class="linenos">10</span>    <span class="n">response</span> <span class="o">=</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;core/register.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;form&#39;</span><span class="p">:</span> <span class="n">form</span><span class="p">})</span>
<span class="linenos">11</span>
<span class="linenos">12</span>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;POST&quot;</span><span class="p">:</span>
<span class="linenos">13</span>        <span class="c1"># Reemplazamos el formulario:</span>
<span class="linenos">14</span>        <span class="n">form</span> <span class="o">=</span> <span class="n">CreationWithEmail</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">)</span>
<span class="linenos">15</span>
<span class="linenos">16</span>        <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
<span class="linenos">17</span>            <span class="n">user</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="linenos">18</span>
<span class="linenos">19</span>            <span class="k">if</span> <span class="n">user</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">20</span>                <span class="n">login</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span>
<span class="linenos">21</span>                <span class="n">response</span> <span class="o">=</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;panel&#39;</span><span class="p">)</span>
<span class="linenos">22</span>
<span class="linenos">23</span>    <span class="k">return</span> <span class="n">response</span>
<span class="linenos">24</span>
<span class="linenos">25</span>
<span class="linenos">26</span><span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<span class="linenos">27</span>    <span class="c1"># Reemplazamos el formulario:</span>
<span class="linenos">28</span>    <span class="n">form</span> <span class="o">=</span> <span class="n">AuthenticationEmail</span><span class="p">()</span>
<span class="linenos">29</span>    <span class="n">response</span> <span class="o">=</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s2">&quot;core/login.html&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;form&#39;</span><span class="p">:</span> <span class="n">form</span><span class="p">})</span>
<span class="linenos">30</span>
<span class="linenos">31</span>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
<span class="linenos">32</span>    <span class="c1"># Reemplazamos el formulario:</span>
<span class="linenos">33</span>        <span class="n">form</span> <span class="o">=</span> <span class="n">AuthenticationEmail</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">)</span>
<span class="linenos">34</span>
<span class="linenos">35</span>        <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
<span class="linenos">36</span>            <span class="n">username</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span>
<span class="linenos">37</span>            <span class="n">password</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]</span>
<span class="linenos">38</span>
<span class="linenos">39</span>            <span class="n">user</span> <span class="o">=</span> <span class="n">authenticate</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">)</span>
<span class="linenos">40</span>
<span class="linenos">41</span>            <span class="k">if</span> <span class="n">user</span><span class="p">:</span>
<span class="linenos">42</span>                <span class="n">login</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span>
<span class="linenos">43</span>                <span class="n">response</span> <span class="o">=</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;panel&#39;</span><span class="p">)</span>
<span class="linenos">44</span>
<span class="linenos">45</span>    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
</section>
</section>
<section id="permisos">
<h3><a class="toc-backref" href="#id58">Permisos</a><a class="headerlink" href="#permisos" title="Enlazar permanentemente con este título">#</a></h3>
<p>Los permisos al igual que los grupos se generan por defecto con Django. En el caso de los permisos estos se generan nuevos (lectura, escritura, edición y borrado) con cada
aplicación que se crea nueva en el proyecto.</p>
<p>Existen dos formas de editar permisos:</p>
<ol class="arabic simple">
<li><p>Desde el panel de administración: seleccionar un usuario y añadir los permisos que debe tener.</p></li>
<li><p>Desde la base de datos: Se pueden añadir, editar o borrar en la tabla <strong>auth_user_user_permissions</strong>. Se puede contrastar el id del campo <strong>permission_id</strong> con el campo <strong>codename</strong> de la tabla <strong>permission</strong> para así usarlo con una función especial en el código:</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">def</span> <span class="nf">post</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
<span class="linenos"> 2</span>    <span class="c1"># Se consulta si el usuario tiene el permiso en base a la app (API) y el nombre del permiso (add_consola):</span>
<span class="linenos"> 3</span>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s1">&#39;API.add_consola&#39;</span><span class="p">):</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span>        <span class="n">serializer</span> <span class="o">=</span> <span class="n">ConsolaSerializer</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="linenos"> 6</span>        <span class="k">if</span> <span class="n">serializer</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
<span class="linenos"> 7</span>            <span class="n">serializer</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="linenos"> 8</span>            <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="n">serializer</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_201_CREATED</span><span class="p">)</span>
<span class="linenos"> 9</span>        <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="n">serializer</span><span class="o">.</span><span class="n">errors</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_400_BAD_REQUEST</span><span class="p">)</span>
<span class="linenos">10</span>    <span class="c1"># sino se le revoca la acción:</span>
<span class="linenos">11</span>    <span class="k">else</span><span class="p">:</span>
<span class="linenos">12</span>        <span class="k">return</span> <span class="n">Response</span><span class="p">({</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;Operación no AUTORIZADA&#39;</span><span class="p">})</span>
</pre></div>
</div>
</section>
</section>
<section id="panel-de-administracion">
<h2><a class="toc-backref" href="#id59">Panel de administración</a><a class="headerlink" href="#panel-de-administracion" title="Enlazar permanentemente con este título">#</a></h2>
<p>El panel de Administración de Django es un modelo CRUD ya definido por defecto con todo el Scaffold del sistema login preparado por defecto.</p>
<section id="puesta-en-marcha">
<h3><a class="toc-backref" href="#id60">Puesta en marcha</a><a class="headerlink" href="#puesta-en-marcha" title="Enlazar permanentemente con este título">#</a></h3>
<p>Para poner en marcha el panel tenemos que hacer un par de cosas en consola:</p>
<ul class="simple">
<li><p>Primero tenemos que crear todo el Scaffold ejecutando <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">migrate</span></code></p></li>
<li><p>Después ejecutamos <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">createsuperuser</span></code> para generar un nuevo superusuario.</p></li>
</ul>
<p>Ahora ya podemos acceder al panel de administración desde la ruta <code class="docutils literal notranslate"><span class="pre">localhost:8000/admin</span></code></p>
</section>
<section id="mostrar-datos-de-nuestros-modelos">
<h3><a class="toc-backref" href="#id61">Mostrar datos de nuestros modelos</a><a class="headerlink" href="#mostrar-datos-de-nuestros-modelos" title="Enlazar permanentemente con este título">#</a></h3>
<p>El panel de Administración solo dispone por defecto de las tablas de usuarios. Pero si hemos creado un modelo debemos implementarlo,
para ello en la carpeta de nuestra app veremos un archivo admin.py el cual editamos:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="linenos">2</span>
<span class="linenos">3</span><span class="c1"># Importamos el modelo:</span>
<span class="linenos">4</span><span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Prueba</span>
<span class="linenos">5</span>
<span class="linenos">6</span><span class="c1"># Registramos en el panel el modelo:</span>
<span class="linenos">7</span><span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Prueba</span><span class="p">)</span>
</pre></div>
</div>
<p>De este modo podremos leer, editar, borrar y añadir registros a esta tabla de nuestra app.</p>
</section>
<section id="personalizar-titulos-de-las-apps">
<h3><a class="toc-backref" href="#id62">Personalizar titulos de las Apps</a><a class="headerlink" href="#personalizar-titulos-de-las-apps" title="Enlazar permanentemente con este título">#</a></h3>
<p>En el panel de administración vemos que las tablas se irán dividiendo en apartados según su app, si tenemos varias apps veremos que cada
tabla esta dentro de apartados. Podemos cambiar el título de estos apartados accediendo a nuestra app y editando el archivo app.py:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kn">from</span> <span class="nn">django.apps</span> <span class="kn">import</span> <span class="n">AppConfig</span>
<span class="linenos">2</span>
<span class="linenos">3</span>
<span class="linenos">4</span><span class="k">class</span> <span class="nc">nombre_de_tu_appConfig</span><span class="p">(</span><span class="n">AppConfig</span><span class="p">):</span>
<span class="linenos">5</span>    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;nombre_de_tu_app&#39;</span>
<span class="linenos">6</span>
<span class="linenos">7</span>    <span class="c1"># Podemos asignarle un nombre que veremos en el panel:</span>
<span class="linenos">8</span>    <span class="n">verbose_name</span> <span class="o">=</span> <span class="s1">&#39;App de Prueba&#39;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Para que esto funcione tenemos que exportar dicha configuración a settings.py:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">[</span>
<span class="linenos">2</span>    <span class="s1">&#39;django.contrib.admin&#39;</span><span class="p">,</span>
<span class="linenos">3</span>    <span class="s1">&#39;django.contrib.auth&#39;</span><span class="p">,</span>
<span class="linenos">4</span>    <span class="s1">&#39;django.contrib.contenttypes&#39;</span><span class="p">,</span>
<span class="linenos">5</span>    <span class="s1">&#39;django.contrib.sessions&#39;</span><span class="p">,</span>
<span class="linenos">6</span>    <span class="s1">&#39;django.contrib.messages&#39;</span><span class="p">,</span>
<span class="linenos">7</span>    <span class="s1">&#39;django.contrib.staticfiles&#39;</span><span class="p">,</span>
<span class="linenos">8</span>    <span class="s1">&#39;nombre_de_tu_app.apps.nombre_de_tu_appConfig&#39;</span> <span class="c1"># cambiamos el nombre de la app por su clase configuradora.</span>
<span class="linenos">9</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="personalizar-tablas">
<h3><a class="toc-backref" href="#id63">Personalizar tablas</a><a class="headerlink" href="#personalizar-tablas" title="Enlazar permanentemente con este título">#</a></h3>
<p>Cuando accedemos a una tabla podemos ver una lista con todos los títulos o el valor que hayamos devuelto en el modelo. Pero podemos modificar su comportamiento
editando el archivo admin.py:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="linenos"> 2</span><span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Prueba</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="c1"># Creamos una clase que se encargará de editar las configuraciones de nuestro panel:</span>
<span class="linenos"> 5</span><span class="k">class</span> <span class="nc">PruebaAdmin</span><span class="p">(</span><span class="n">admin</span><span class="o">.</span><span class="n">ModelAdmin</span><span class="p">):</span>
<span class="linenos"> 6</span>    <span class="c1"># con esta tupla definimos los campos que serán de solo lectura cuando abramos un registro.</span>
<span class="linenos"> 7</span>    <span class="n">readonly_fields</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;fecha_creacion&#39;</span><span class="p">,</span> <span class="s1">&#39;fecha_edicion&#39;</span><span class="p">)</span>
<span class="linenos"> 8</span>    <span class="c1"># Con list_display definimos que campos se mostrarán en el listado:</span>
<span class="linenos"> 9</span>    <span class="n">list_display</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;titulo&#39;</span><span class="p">,</span> <span class="s1">&#39;autor&#39;</span><span class="p">,</span> <span class="s1">&#39;descripcion&#39;</span><span class="p">,</span> <span class="s1">&#39;fecha_creacion&#39;</span><span class="p">)</span>
<span class="linenos">10</span>    <span class="c1"># Aquí también podemos establecer el orden de lista:</span>
<span class="linenos">11</span>    <span class="n">ordering</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;fecha_creacion&#39;</span><span class="p">,</span> <span class="s1">&#39;titulo&#39;</span><span class="p">)</span>
<span class="linenos">12</span>
<span class="linenos">13</span>    <span class="c1"># Opcionalmente podemos cambiar la jerarquía de los breadcums para que se muestren por fecha de publicación:</span>
<span class="linenos">14</span>    <span class="n">date_hierarchy</span> <span class="o">=</span> <span class="s1">&#39;fecha_publicacion&#39;</span>
<span class="linenos">15</span>
<span class="linenos">16</span>    <span class="c1"># Filtrar también los datos que se muestran en la barra lateral derecha:</span>
<span class="linenos">17</span>    <span class="n">list_filter</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;autor__username&#39;</span><span class="p">,</span> <span class="s1">&#39;fecha_creacion&#39;</span><span class="p">)</span>
<span class="linenos">18</span>
<span class="linenos">19</span><span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Prueba</span><span class="p">,</span> <span class="n">PruebaAdmin</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="cambiar-titulo-al-panel">
<h3><a class="toc-backref" href="#id64">Cambiar título al panel</a><a class="headerlink" href="#cambiar-titulo-al-panel" title="Enlazar permanentemente con este título">#</a></h3>
<p>Para cambiar el título que se muestra en el panel es tan sencillo como irnos a urls.py principal y al final del archivo añadir:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Cambiar el título:</span>
<span class="linenos">2</span><span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">site_header</span> <span class="o">=</span> <span class="s1">&#39;Mi Sitio web&#39;</span>
<span class="linenos">3</span>
<span class="linenos">4</span><span class="c1"># Cambiar el subtítulo:</span>
<span class="linenos">5</span><span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">index_title</span> <span class="o">=</span> <span class="s1">&#39;Panel de Administración&#39;</span>
<span class="linenos">6</span>
<span class="linenos">7</span><span class="c1"># cambiar texto de la pestaña de navegación:</span>
<span class="linenos">8</span><span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">site_title</span> <span class="o">=</span> <span class="s1">&#39;Mi sitio web dedicado a Django!!!&#39;</span>
</pre></div>
</div>
</section>
</section>
<section id="enviar-emails">
<h2><a class="toc-backref" href="#id65">Enviar Emails</a><a class="headerlink" href="#enviar-emails" title="Enlazar permanentemente con este título">#</a></h2>
<p>libreria send_email() send_mass_email() en HTML también</p>
<p>…</p>
<p><a class="reference external" href="https://docs.djangoproject.com/en/4.0/topics/email/">https://docs.djangoproject.com/en/4.0/topics/email/</a></p>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="analisis.html" title="anterior página">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">anterior</p>
            <p class="prev-next-title">Análisis de datos</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="flask.html" title="siguiente página">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">siguiente</p>
        <p class="prev-next-title">Microframework: Flask</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Guillermo Granados Gomez<br/>
  
      &copy; Copyright Creado por Guillermo Granados Gomez bajo Licencia MIT.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>